2006 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e map list list types assignment types variable types label types label alphabet types labels types labels sequence types alphabet types alphabet carrying gnu trove t hash map gnu trove t list a special kind assignment variables that can be arranged in a labels sequence an adaptor to adapt labels sequences to assignments <p > $ labels assignment v 1 1 2007 10 22 21 37 58 exp $ labels assignment assignment alphabet carrying these are just printing race conditions t matter n e x t = 0 = n e x t id++ variable idx2var labels sequence lblseq map var2label labels assignment labels sequence lbls lblseq = lbls setup label2 var add row to variable to value variable to variable list vars = list max time num slices t = 0 t < idx2var length t++ j = 0 j < idx2var t length j++ vars add idx2var t j variable vars to variable vars size to value t list vals = t list max time num slices t = 0 t < lblseq size t++ labels lbls = lblseq get labels t j = 0 j < lbls size j++ label lbl = lbls get j vals add lbl get index vals to setup label2 var idx2var = variable lblseq size var2label = t hash map t = 0 t < lblseq size t++ labels lbls = lblseq get labels t idx2var t = variable lbls size j = 0 j < lbls size j++ label lbl = lbls get j variable var = variable lbl get label alphabet var set label i +id+ v a r f= + j + tm= + t + idx2var t j = var var2label put var lbl variable var index t j idx2var t j label label var variable var label var2label get var max time lblseq size assumes that lblseq not ragged num slices idx2var 0 length labels sequence get labels sequence lblseq labels sequence to labels sequence assignment assn num factors = num slices max time = max time labels lbls = labels max time t = 0 t < max time t++ label these labels = label num factors i = 0 i < num factors i++ variable var = var index t i maxidx var != maxidx = assn get var maxidx = 0 label alphabet dict = label var var get label alphabet these labels i = dict lookup label maxidx lbls t = labels these labels labels sequence lbls label alphabet get output alphabet lvl idx2var 0 lvl get label alphabet alphabet get alphabet get output alphabet 0 alphabet get alphabets alphabet get alphabet hack 
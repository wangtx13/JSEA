2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e author andrew mc callum <a href= mailto >mccallum edu< a> classify tests junit framework net u r i io classify pipe pipe iterator iterator pipe iterator iterator types test naive bayes test test naive bayes name name test non trained alphabet fdict = alphabet out fdict size= +fdict size label alphabet ldict = label alphabet multinomial estimator me1 = multinomial laplace estimator fdict multinomial estimator me2 = multinomial laplace estimator fdict prior ldict lookup index sports ldict lookup index politics ldict stop growth out ldict size= +ldict size multinomial prior = multinomial 5 5 ldict sports me1 increment win 5 me1 increment puck 5 me1 increment team 5 out fdict size= +fdict size politics me2 increment win 5 me2 increment speech 5 me2 increment vote 5 multinomial sports = me1 estimate multinomial politics = me2 estimate we must estimate from me1 and me2 after all data incremented so that sports multinomial knows full dictionary size! classifier = naive bayes noop fdict ldict prior multinomial sports politics instance inst = get instance pipe instance from instance feature vector fdict speech win 1 1 ldict lookup label politics out inst data = +inst get data classification cf = classify inst label vector l = label vector cf get labeling out l size= +l size out l get best index= +l get best index cf get labeling get best label == ldict lookup label politics cf get labeling get best value > 0 6 test trained africa training = on plains africa lions roar in swahili ngoma means to dance nelson mandela became president south africa saraha dessert expanding asia training = panda bears eat bamboo china s one child policy has resulted in a surplus boys tigers live in jungle instance list instances = instance list serial pipes pipe target2 label sequence2 token sequence token sequence2 feature sequence feature sequence2 feature vector instances add thru pipe iterator africa training africa instances add thru pipe iterator asia training asia classifier = naive bayes trainer train instances classification cf = classify nelson mandela never eats lions cf get labeling get best label == label alphabet instances get target alphabet lookup label africa test random trained instance list ilist = instance list randoms 1 10 2 classifier = naive bayes trainer train ilist test on training data num correct = 0 i = 0 i < ilist size i++ instance inst = ilist get i classification cf = classify inst cf print cf get labeling get best label == inst get labeling get best label num correct++ out accuracy on training set = + num correct ilist size test incrementally trained growing alphabets out test incrementally trained growing alphabets = src classify tests naive bayes data learn a src classify tests naive bayes data learn b directories = length i = 0 i < length i++ directories i = i serial pipes inst pipe = m a l l e t pipeline converting instances to feature vectors serial pipes pipe target2 label input2 sequence s k i p h e a d e r only works unix subsequence subsequence s k i p h e a d e r sequence2 token sequence token sequence lowercase token sequence remove stopwords token sequence2 feature sequence feature sequence2 feature vector instance list inst list = instance list inst pipe inst list add thru pipe iterator directories iterator s t a r t i n g d i r e t o r i e s out training 1 naive bayes trainer trainer = naive bayes trainer naive bayes classifier = trainer train incremental inst list inst list get data alphabet stop growth incrementally train t2directories = src classify tests naive bayes data learn b out data alphabet size + inst list get data alphabet size out target alphabet size + inst list get target alphabet size instance list inst list2 = instance list inst pipe inst list2 add thru pipe iterator t2directories iterator s t a r t i n g d i r e t o r i e s out training 2 out data alphabet size + inst list2 get data alphabet size out target alphabet size + inst list2 get target alphabet size naive bayes classifier2 = naive bayes trainer train incremental inst list2 test incrementally trained out test incrementally trained = src classify tests naive bayes data learn a src classify tests naive bayes data learn b directories = length i = 0 i < length i++ directories i = i serial pipes inst pipe = m a l l e t pipeline converting instances to feature vectors serial pipes pipe target2 label input2 sequence s k i p h e a d e r only works unix subsequence subsequence s k i p h e a d e r sequence2 token sequence token sequence lowercase token sequence remove stopwords token sequence2 feature sequence feature sequence2 feature vector instance list inst list = instance list inst pipe inst list add thru pipe iterator directories iterator s t a r t i n g d i r e t o r i e s out training 1 naive bayes trainer trainer = naive bayes trainer naive bayes classifier = naive bayes trainer train incremental inst list classification initial classification = classifier classify hello everybody classification initial2 classification = classifier classify goodbye now out initial classification = initial classification print initial2 classification print out data alphabet + classifier get alphabet out label alphabet + classifier get label alphabet incrementally train t2directories = src classify tests naive bayes data learn b out data alphabet size + inst list get data alphabet size out target alphabet size + inst list get target alphabet size instance list inst list2 = instance list inst pipe inst list2 add thru pipe iterator t2directories iterator s t a r t i n g d i r e t o r i e s out training 2 out data alphabet size + inst list2 get data alphabet size out target alphabet size + inst list2 get target alphabet size naive bayes classifier2 = naive bayes trainer train incremental inst list2 test empty bug out test empty bug = src classify tests naive bayes data learn a src classify tests naive bayes data learn b directories = length i = 0 i < length i++ directories i = i serial pipes inst pipe = m a l l e t pipeline converting instances to feature vectors serial pipes pipe target2 label input2 sequence s k i p h e a d e r only works unix subsequence subsequence s k i p h e a d e r sequence2 token sequence token sequence lowercase token sequence remove stopwords token sequence2 feature sequence feature sequence2 feature vector instance list inst list = instance list inst pipe inst list add thru pipe iterator directories iterator s t a r t i n g d i r e t o r i e s out training 1 naive bayes trainer trainer = naive bayes trainer naive bayes classifier = naive bayes trainer train incremental inst list classification initial classification = classifier classify hello everybody classification initial2 classification = classifier classify goodbye now out initial classification = initial classification print initial2 classification print out data alphabet + classifier get alphabet out label alphabet + classifier get label alphabet test t2directories = src classify tests naive bayes data learn b out data alphabet size + inst list get data alphabet size out target alphabet size + inst list get target alphabet size instance list inst list2 = instance list inst pipe inst list2 add thru pipe iterator t2directories iterator s t a r t i n g d i r e t o r i e s out training 2 out data alphabet size + inst list2 get data alphabet size out target alphabet size + inst list2 get target alphabet size naive bayes classifier2 = naive bayes trainer train incremental inst list2 classification second classification = classifier classify goodbye now second classification print test suite test suite test naive bayes test suite suite= test suite suite add test test naive bayes test incrementally trained suite add test test naive bayes test empty bug suite set up junit textui test runner run suite 
2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e classify io i o io input stream io output stream io serializable pipe pipe types feature vector types instance types label vector types matrix ops classification balanced winnow algorithm balanced winnow trainer author gary huang <a href= mailto ghuang >ghuang edu< a> balanced winnow classifier serializable m weights passes along data pipe and weights from link # balanced winnow trainer balanced winnow trainer data pipe needed dictionary labels feature vectors etc weights weights calculated during training phase balanced winnow pipe data pipe weights data pipe m weights = weights length weights 0 length i = 0 i < weights length i++ j = 0 j < weights 0 length j++ m weights i j = weights i j a copy weight vectors get weights num cols = m weights 0 length ret = m weights length num cols i = 0 i < ret length i++ arraycopy m weights i 0 ret i 0 num cols ret classifies an instance using balanced winnow s weights <p> a classification containing normalized dot products between weight vectors and instance feature vector <p> one can obtain confidence classification calculating weight j weight j where j highest weight prediction and j 2nd highest another possibility to calculate <br><tt><center>e^ dot w j x sum j e^ dot w j x < center>< tt> classification classify instance instance num classes = get label alphabet size num feats = get alphabet size scores = num classes feature vector fv = feature vector instance get data make sure feature vector s feature dictionary matches what we are expecting from our data pipe and thus our notion feature probabilities instance pipe == || fv get alphabet == instance pipe get data alphabet fvisize = fv num locations take dot products sum = 0 ci = 0 ci < num classes ci++ fvi = 0 fvi < fvisize fvi++ fi = fv index at location fvi vi = fv value at location fvi m weights ci length > fi scores ci += vi m weights ci fi sum += vi m weights ci fi scores ci += m weights ci num feats sum += m weights ci num feats matrix ops times equals scores 1 0 sum create and a classification classification instance label vector get label alphabet scores serialization serial u overriden to prevent innocuous changes in from making serialization mechanism think external format has changed serial u = 1 u r r e n t s e r i a l v e r s i o n = 1 write output stream out i o out write u r r e n t s e r i a l v e r s i o n out write get instance pipe write weight vector each out write m weights read input stream in i o not found = in read != u r r e n t s e r i a l v e r s i o n not found mismatched balanced winnow versions wanted + u r r e n t s e r i a l v e r s i o n + got + instance pipe = pipe in read m weights = in read 
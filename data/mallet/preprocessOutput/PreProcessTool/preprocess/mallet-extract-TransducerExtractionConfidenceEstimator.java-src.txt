2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e author aron culotta <a href= mailto culotta >culotta edu< a> extract io confidence pipe types estimates confidence in labeling a labeled span using a transducer confidence estimator transducer extraction confidence estimator extraction confidence estimator serializable transducer confidence estimator confidence estimator pipe feature pipe transducer extraction confidence estimator transducer confidence estimator confidence estimator start tags tags pipe feature pipe confidence estimator = confidence estimator feature pipe = feature pipe estimate confidence document extraction document extraction tokenization input = document extraction get input w a r n i n g input tokenization will likely already have many features appended from last time it was passed through a feature pipe to avoid a redundant calculation features caller may want to set feature pipe = token sequence2 feature vector sequence instance carrier = feature pipe pipe instance input sequence piped input = sequence carrier get data sequence prediction = document extraction get predicted labels labeled spans labeled spans = document extraction get extracted spans sum lattice lattice = sum lattice confidence estimator get transducer piped input i=0 i < labeled spans size i++ labeled span span = labeled spans get labeled span i span background segment boundaries = get segment boundaries input span segment segment = segment piped input prediction prediction segment boundaries 0 segment boundaries 1 span set confidence confidence estimator estimate confidence segment lattice convert indices a labeled span into indices a tokenization size two where first index start token second end token inclusive get segment boundaries tokenization tokens labeled span labeled span start index = labeled span get start idx end index = labeled span get end idx 1 ret = 1 1 i=0 i < tokens size i++ index = tokens get span i get start idx index <= end index index >= start index ret 0 == 1 ret 0 = i ret 1 = i ret 1 = i ret 0 == 1 || ret 1 == 1 illegal argument unable to find segment boundaries from span + labeled span ret 
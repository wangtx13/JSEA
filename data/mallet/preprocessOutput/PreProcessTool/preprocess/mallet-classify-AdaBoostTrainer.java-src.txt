2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e classify random logging types logger maths ada boost should be used only binary classification use ada boost m2 multi problems <p> robert e schapire a decision theoretic generalization on line and an application to boosting in journal and sciences princeton ~schapire uncompress papers cgi freund sc95 ps author andrew mc callum <a href= mailto >mccallum edu< a> ada boost trainer classifier trainer< ada boost> logger logger = logger get logger ada boost trainer get name m a x n u m r e s a m p l i n g i t e r a t i o n s = 10 classifier trainer weak learner num rounds ada boost classifier ada boost get classifier classifier ada boost trainer classifier trainer weak learner num rounds ! weak learner boostable illegal argument weak learner not boostable num rounds <= 0 illegal argument number rounds must be positive weak learner = weak learner num rounds = num rounds ada boost trainer classifier trainer weak learner weak learner 100 boosting that resamples instances using their weights ada boost train instance list training list feature selection selected features = training list get feature selection selected features != unsupported operation feature selection not yet random random = random set initial weights to be uniform w = 1 0 training list size instance list training insts = instance list training list get pipe training list size i = 0 i < training list size i++ training insts add training list get i w correct = training insts size num classes = training insts get target alphabet size num classes != 2 logger info ada boost trainer train w a r n i n g more than two classes classifier weak learners = classifier num rounds alphas = num rounds instance list round training insts = instance list training insts get pipe boosting iterations round = 0 round < num rounds round++ logger info =========== ada boost trainer round + round+1 + begin keep resampling training instances using instance weights on which to train weak learner until either we exceed preset number maximum iterations or weak learner makes a non zero on training insts makes sure we sample at least some hard instances resampling iterations = 0 err err = 0 round training insts = training insts sample instance weights random weak learners round = weak learner train round training insts calculate i = 0 i < training insts size i++ instance inst = training insts get i weak learners round classify inst best label correct correct i = correct i = err += training insts get instance weight i resampling iterations++ maths almost equals err 0 resampling iterations < m a x n u m r e s a m p l i n g i t e r a t i o n s stop boosting when too big or 0 ignoring weak classifier trained round maths almost equals err 0 || err > 0 5 logger info ada boost trainer stopped at + round+1 + + num rounds + rounds num classes= + num classes + error= + err we are in first round have to use weak classifier in any num classifiers to use = round == 0 ? 1 round round == 0 alphas 0 = 1 betas = num classifiers to use classifier weak classifiers = classifier num classifiers to use arraycopy alphas 0 betas 0 num classifiers to use arraycopy weak learners 0 weak classifiers 0 num classifiers to use i = 0 i < betas length i++ logger info ada boost trainer weight weak learner + i + = + betas i ada boost round training insts get pipe weak classifiers betas calculate weight to assign to weak classifier formula really designed binary classifiers that t give a confidence score use ada boost m h multi or multi labeled data alphas round = math log 1 err err reweight factor = err 1 err sum = 0 decrease weights correctly classified instances i = 0 i < training insts size i++ w = training insts get instance weight i correct i w = reweight factor training insts set instance weight i w sum += w normalize instance weights i = 0 i < training insts size i++ training insts set instance weight i training insts get instance weight i sum logger info =========== ada boost trainer round + round+1 + finished weak classifier training = + err i = 0 i < alphas length i++ logger info ada boost trainer weight weak learner + i + = + alphas i classifier = ada boost round training insts get pipe weak learners alphas classifier 
2003 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e logging logger arrays io print stream text decimal format types logger determines precision recall and f1 on a per basis author charles sutton $ per accuracy evaluator v 1 1 2007 10 22 21 37 48 exp $ per accuracy evaluator transducer evaluator logger logger = logger get logger token accuracy evaluator get name per accuracy evaluator instance list instance lists descriptions instance lists descriptions per accuracy evaluator instance list i1 d1 instance list i1 d1 per accuracy evaluator instance list i1 d1 instance list i2 d2 instance list i1 i2 d1 d2 evaluate instance list transducer trainer tt instance list data description transducer model = tt get transducer alphabet dict = model get input pipe get target alphabet num labels = dict size num correct tokens = num labels num pred tokens = num labels num tokens = num labels logger info per token results + description i = 0 i < data size i++ instance instance = data get i sequence input = sequence instance get data sequence output = sequence instance get target input size == output size sequence pred output = model transduce input pred output size == output size j = 0 j < output size j++ idx = dict lookup index output get j num tokens idx ++ num pred tokens dict lookup index pred output get j ++ output get j equals pred output get j num correct tokens idx ++ decimal format f = decimal format 0 #### allf = num labels i = 0 i < num labels i++ label = dict lookup i precision = num correct tokens i num pred tokens i recall = num correct tokens i num tokens i f1 = 2 precision recall precision + recall ! na n f1 allf i = f1 logger info description + label + label + p + f format precision + r + f format recall + f1 + f format f1 logger info macro average f1 +f format matrix ops mean allf 
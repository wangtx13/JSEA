2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e author andrew mc callum <a href= mailto >mccallum edu< a> optimize logging types matrix ops logger gradient ascent optimizer logger logger = logger get logger gradient ascent get name converged = optimizable gradient value optimizable max step = 1 0 optimizer evaluator gradient eval initial step size = 0 2 tolerance = 0 001 max iterations = 200 line optimizer gradient line maximizer stpmax = 100 eps a small number to rectify special converging to exactly zero function value eps = 1 0e 10 step = initial step size gradient ascent optimizable gradient value function optimizable = function line maximizer = back track line search function optimizable get optimizable optimizable converged converged line optimizer gradient get line maximizer line maximizer tricky now set at gradient ascent construction time how to set it later? what to pass an argument here? line maximizer needs function at time its construction! set line maximizer line optimizer gradient line maximizer line maximizer = line maximizer sets tolerance in convergence test 2 0 |value old value| <= tolerance |value|+|old value|+eps value 0 001 tolerance tolerance convergence test set tolerance tolerance tolerance = tolerance get initial step size initial step size set initial step size initial step size step = initial step size get stpmax stpmax set stpmax stpmax stpmax = stpmax optimize optimize max iterations optimize num iterations iterations fret fp = optimizable get value xi = optimizable get num optimizable get value gradient xi iterations = 0 iterations < num iterations iterations++ logger info at iteration +iterations+ cost = +fp+ scaled = +max step+ step = +step+ gradient infty norm = + matrix ops infinity norm xi ensure step not too large sum = matrix ops two norm xi sum > stpmax logger info step 2 norm +sum+ greater than max +stpmax+ scaling matrix ops times equals xi stpmax sum step = line maximizer optimize xi step fret = optimizable get value 2 0 math abs fret fp <= tolerance math abs fret + math abs fp +eps logger info gradient ascent value difference + math abs fret fp + below + tolerance saying converged converged = fp = fret optimizable get value gradient xi eval != eval evaluate optimizable iterations set max step size v max step = v set evaluator optimizer evaluator gradient eval eval = eval 
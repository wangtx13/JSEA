2003 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e templates gnu trove t hash map io i o io input stream io output stream io serializable iterator list regex pattern regex matcher a r f types variable labels assignment t hash multi map types template adding skip edges in author charles sutton $ similar tokens template v 1 1 2007 10 22 21 38 02 exp $ copied from t u iacrfpublic similar tokens template a r f sequence template debug = token info feature name feature vector fv pos token info feature name feature vector fv pos feature name = feature name fv = fv pos = pos factor distinguish endpts = word features only = exclude adjacent = feature vector binner binner maps feature vector sequence ==> t hash multi map< token info> t hash map instance cache = t hash map similar tokens template factor factor similar tokens template factor distinguish endpoints factor distinguish endpoints cap words binner similar tokens template factor distinguish endpoints word features only factor distinguish endpoints word features only cap words binner similar tokens template factor distinguish endpoints feature vector binner binner factor distinguish endpoints binner similar tokens template factor distinguish endpoints word features only feature vector binner binner factor = factor distinguish endpts = distinguish endpoints word features only = word features only binner = binner add instantiated cliques a r f unrolled graph graph feature vector sequence fvs labels assignment lblseq t hash multi map fv word = construct fv word fvs num skip = 0 iterator it = fv word key set iterator it has next word feature = it next list info list = list fv word get word feature n = info list size debug n > 1 err print processing list size + n+ +word feature+ i = 0 i < n i++ j = i + 1 j < n j++ token info info1 = token info info list get i token info info2 = token info info list get j variable v1 = lblseq var index info1 pos factor variable v2 = lblseq var index info2 pos factor exclude adjacent math abs info1 pos info2 pos <= 1 variable vars = variable v1 v2 v1 != couldn t get label factor + factor + time + i v2 != couldn t get label factor + factor + time + j feature vector fv = combine fv word feature info1 fv info2 fv a r f unrolled var set clique = a r f unrolled var set graph vars fv graph add clique clique num skip++ out adding +info1 pos+ +info2 pos insanely verbose debug err combining +info1 fv+ +info2 fv debug n > 1 err done err similar tokens template total skip edges = +num skip t hash multi map construct fv word feature vector sequence fvs t hash multi map fv word = t hash multi map fvs size n = fvs size t = 0 t < n t++ feature vector fv = fvs get feature vector t word feature = binner compute bin fv word feature != could happen current word has been excluded fv word put word feature token info word feature fv t fv word feature vector combine fv word feature vector fv1 feature vector fv2 out combine fv out f v1 values +fv1 get values + indices +fv1 get indices out f v1 +fv1 to out f v2 values +fv2 get values + indices +fv2 get indices out f v2 +fv2 to alphabet dict = fv1 get alphabet augmentable feature vector afv = augmentable feature vector dict word features only idx = dict lookup index word afv add idx 1 0 distinguish endpts afv add fv1 s afv add fv2 e afv add fv1 afv add fv2 out a f v +afv to afv customization classes that ssigns each features vector to a valued bin feature vectors same bin are assumed to be similar so that they need a skip edge in way similarity metric used generating skip edges can be completely customized feature vector binner compute bin feature vector fv word feature binner feature vector binner serializable pattern find word ptn1 = pattern compile w o r d= pattern find word ptn2 = pattern compile w= pattern find word exclude ptn = pattern compile ? ?\\d+| pattern word include pattern = word feature binner word feature binner pattern word include pattern word include pattern = word include pattern compute bin feature vector fv text = intuit token text fv text != word include pattern == || word include pattern matcher text matches text intuit token text feature vector fv alphabet dict = fv get alphabet loc = 0 loc < fv num locations loc++ idx = fv index at location loc fname = value dict lookup idx matcher matcher matcher = find word ptn1 matcher fname matches !find word exclude ptn matcher fname matches matcher group 1 find word ptn2 != matcher = find word ptn2 matcher fname matches !find word exclude ptn matcher fname matches matcher group 1 serialization garbage serial u = 1 u r r e n t s e r i a l v e r s i o n = 2 write output stream out i o out write out write u r r e n t s e r i a l v e r s i o n read input stream in i o not found in read = in read == 1 runtime cap words binner word feature binner cap words binner pattern compile a z a za z set binner feature vector binner binner binner = binner exclude adjacent exclude adjacent set exclude adjacent exclude adjacent exclude adjacent = exclude adjacent distinguish endpts distinguish endpts set distinguish endpts distinguish endpts distinguish endpts = distinguish endpts serialization garbage serial u = 1 u r r e n t s e r i a l v e r s i o n = 2 write output stream out i o out write out write u r r e n t s e r i a l v e r s i o n read input stream in i o not found in read = in read instance cache = t hash map 
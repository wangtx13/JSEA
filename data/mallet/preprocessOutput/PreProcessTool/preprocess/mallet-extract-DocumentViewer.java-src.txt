2003 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e extract io io print writer io writer io i o list list types label types label alphabet color utils diagnosis that outputs h t m l pages that allows you to view errors on a more global per instance basis created mar 30 2005 author < a h r e f= mailto casutton edu>casutton edu< a> $ document viewer v 1 1 2007 10 22 21 37 44 exp $ document viewer d o e r r s s s f n a m e = docerrs css d o e r r s p r e d s s f n a m e = docerrs pred css d o e r r s t r u e s s f n a m e = docerrs css s a t u r a t i o n = 0 4 dual labeled spans dual labeled spans labeled spans ls1 labeled spans ls2 ls = labeled spans ls1 ls2 labeled spans ls size ls 0 size labeled span get t i ls i get labeled span t writes several h t m l files describing a given extraction each h t m l shows an entire document extracted fields color coded directory directory to write files to extraction extraction to describe i o write extraction directory extraction extraction i o output index directory extraction output stylesheets directory extraction output documents directory extraction output stylesheets directory extraction extraction i o e r r s css print writer out = print writer writer directory d o e r r s s s f n a m e out tf legend border style dashed border width 2px padding 10px padding top 0ex right margin 2em out legend visibility hidden out correct background color #33 f f33 out wrong background color pink out background color #99 f f out pred background color # f f f f66 out close p r e d css label alphabet dict = extraction get label alphabet fields = determine field names dict colors = color utils rainbow fields length s a t u r a t i o n 1 out = print writer writer directory d o e r r s p r e d s s f n a m e out legend border style dashed border width 2px padding 10px padding top 0ex right margin 2em out tf legend visibility hidden i = 0 i < fields length i++ out pred +fields i + background color +colors i + out close t r u e css out = print writer writer directory d o e r r s t r u e s s f n a m e out legend border style dashed border width 2px padding 10px padding top 0ex right margin 2em out tf legend visibility hidden i = 0 i < fields length i++ out +fields i + background color +colors i + out close output documents directory extraction extraction i o i = 0 i < extraction get num documents i++ print writer out = print writer writer directory extraction +i+ html output one document out extraction get document extraction i out close output one document print writer out document extraction doc extr name = doc extr get name out < h t m l>< h e a d>< t i t l e> +name+ extraction from document< t i t l e> out < l i n k r e l=\ stylesheet\ t y p e=\ text css\ h r e f=\ + d o e r r s s s f n a m e+ \ title=\ agreement\ > out < l i n k r e l=\ stylesheet\ t y p e=\ text css\ h r e f=\ + d o e r r s p r e d s s f n a m e+ \ title=\ pred\ > out < l i n k r e l=\ stylesheet\ t y p e=\ text css\ h r e f=\ + d o e r r s t r u e s s f n a m e+ \ title=\ true\ > out < h e a d>< b o d y> output legend out doc extr get extracted spans get labeled span 0 get label get label alphabet output right wrong legend out dual labeled spans spans = intersect spans doc extr i = 0 i < spans size i++ labeled span pred span = spans get i 0 labeled span span = spans get i 1 label pred label = pred span get label label label = span get label pred non bgrnd = !pred span background non bgrnd = !true span background background = !pred non bgrnd !true non bgrnd span = pred non bgrnd non bgrnd pred label == label span = correct span = wrong pred non bgrnd span = pred non bgrnd span = !is background out print < s p a n l a s s=\ pred +pred label+ \ > !is background out print < s p a n l a s s=\ +true label+ \ > span != out print < s p a n l a s s=\ +span class+ \ > text = pred span get span get text text = text replace all < lt text = text replace all < p> out print text span != out print < s p a n> !is background out print < s p a n>< s p a n> out out < b o d y>< h t m l> output right wrong legend print writer out out < d i v l a s s=\ tf legend\ >< b> l e g e n d< b>< b r> out < s p a n l a s s= correct > correct< s p a n>< b r > out < s p a n l a s s= wrong > wrong< s p a n>< b r > out < s p a n l a s s= > negative< s p a n> field but predicted background < b r > out < s p a n l a s s= pred > positive< s p a n> background but predicted field < b r > out < d i v> output legend print writer out label alphabet dict out < d i v l a s s=\ legend\ > out < h4> l e g e n d< h4> fields = determine field names dict colors = color utils rainbow fields length s a t u r a t i o n 1 i = 0 i < fields length i++ out < s p a n s t y l e=\ background color +colors i + \ > +fields i + < s p a n>< b r > out < d i v> determine field names label alphabet dict list l = list i = 0 i < dict size i++ lname = dict lookup label i to !lname starts b !lname starts i l add lname l to l size dual labeled spans intersect spans document extraction doc extr pred idx = 0 idx = 0 labeled spans spans = doc extr get target spans labeled spans pred spans = doc extr get extracted spans labeled spans ret pred spans = labeled spans pred spans get document labeled spans ret spans = labeled spans pred spans get document pred idx < pred spans size idx < spans size labeled span pred span = pred spans get labeled span pred idx labeled span span = spans get labeled span idx labeled span pred span = labeled span pred span intersection span labeled span span = labeled span span intersection pred span ret pred spans add pred span ret spans add span pred span get end idx <= span get end idx pred idx++ span get end idx <= pred span get end idx idx++ ret pred spans size == ret spans size dual labeled spans ret pred spans ret spans output index directory extraction extraction i o print writer out = print writer writer directory index html out < h t m l>< h e a d>< t i t l e> extraction results< t i t l e>< h e a d>< b o d y>< o l> i = 0 i < extraction get num documents i++ name = extraction get document extraction i get name out < l i>< a h r e f=\ extraction +i+ html\ > +name+ < a>< l i> out < o l>< b o d y>< h t m l> out close 
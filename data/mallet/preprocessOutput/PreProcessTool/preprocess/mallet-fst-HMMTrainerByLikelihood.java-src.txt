logging logger types feature sequence types instance types instance list logger h m m trainer likelihood transducer trainer logger logger = logger get logger h m m trainer likelihood get name h m m hmm instance list training set unlabeled set iteration count = 0 converged = h m m trainer likelihood h m m hmm hmm = hmm override transducer get transducer hmm override get iteration iteration count override finished training converged override train instance list training set num iterations train training set num iterations train instance list training set instance list unlabeled set num iterations hmm emission estimator == hmm reset converged = threshold = 0 001 log likelihood = n e g a t i v e i n f i n i t y prev log likelihood iter = 0 iter < num iterations iter++ prev log likelihood = log likelihood log likelihood = 0 instance inst training set feature sequence input = feature sequence inst get data feature sequence output = feature sequence inst get target obs likelihood = sum lattice hmm input output hmm incrementor get total weight log likelihood += obs likelihood logger info get value observed log likelihood = + log likelihood unlabeled set != num ex = 0 instance inst unlabeled set num ex++ num ex % 100 == 0 err print num ex + err flush feature sequence input = feature sequence inst get data hidden likelihood = sum lattice hmm input hmm incrementor get total weight log likelihood += hidden likelihood err logger info get value log likelihood = + log likelihood hmm estimate iteration count++ logger info h m m finished one iteration maximizer i= + iter run evaluators math abs log likelihood prev log likelihood < threshold converged = logger info h m m training has converged i= + iter converged 
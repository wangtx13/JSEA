2003 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e inference list list iterator types randoms computes an exact sample from a given factor graph forming a junction tree created nov 9 2005 author < a h r e f= mailto casutton edu>casutton edu< a> $ exact sampler v 1 1 2007 10 22 21 37 49 exp $ exact sampler sampler randoms r exact sampler randoms exact sampler randoms r r = r assignment sample factor graph mdl n junction tree inferencer jti = junction tree inferencer jti compute marginals mdl junction tree jt = jti lookup junction tree var set vs = mdl var set assignment assns = assignment i = 0 i < n i++ assignment assn = sample one assn jt assns add row vs to variable reorder cols assn vs assns reorder cols assignment assn var set vs vals = vs size vi = 0 vi < vs size vi++ vals vi = assn get vs get vi vals assignment sample one assn junction tree jt var set root = var set jt get root sample assignment rec jt assignment root assignment sample assignment rec junction tree jt assignment assn var set var set factor marg = jt get p f var set factor slice = marg slice assn assignment sampled = slice sample r assn = assignment union assn sampled iterator it = jt get children var set iterator it has next var set child = var set it next assignment other = sample assignment rec jt assn child assn = assignment union assn other assn set random randoms r r = r 
regression arrays io text number format types optimize m v normal stat functions coordinate descent linear regression regression instance list training data keep unthresholded values each parameter here scaled residuals tuning constant sum squared x scaled thresholds inverted index feature index intercept index precision index dimension number format formatter coordinate descent instance list data l1 weight tuning constant = l1 weight training data = data regression = linear regression training data get data alphabet = regression get intercept index = length 2 precision index = length 1 formatter = number format get instance formatter set maximum fraction digits 3 we re not concerned precision variable dimension = length 1 scaled residuals = dimension sum squared x = dimension scaled thresholds = dimension feature index = inverted index data instance instance data feature vector predictors = feature vector instance get data y = instance get target value scaled residuals intercept index += y i = 0 i < predictors num locations i++ index = predictors index at location i value = predictors value at location i scaled residuals index += y value sum squared x index += value value data size sum squared values feature scaled residuals intercept index = data size index = 0 index < dimension 1 index++ scaled residuals index = sum squared x index scaled thresholds index = tuning constant sum squared x index converged = iteration = 0 ! converged total diff = 0 diff = intercept index scaled residuals intercept index total diff += math abs diff t use soft threshold intercept intercept index = scaled residuals intercept index update scaled residuals remaining instances instance instance data feature vector predictors = feature vector instance get data i = 0 i < predictors num locations i++ index = predictors index at location i value = predictors value at location i scaled residuals index += value diff sum squared x index index = 0 index < dimension 1 index++ diff = index scaled residuals index > tuning constant index = scaled residuals index tuning constant scaled residuals index < tuning constant index = scaled residuals index + tuning constant diff = index total diff += math abs diff o feature index get instances feature index instance instance = instance o feature vector predictors = feature vector instance get data loop through once to get value we are changing value = 0 0 i = 0 i < predictors num locations i++ predictors index at location i == index value = predictors value at location i update residual intercept scaled residuals intercept index += value diff data size update residual all other non zero features i = 0 i < predictors num locations i++ other index = predictors index at location i other value = predictors value at location i other index != index scaled residuals other index += value other value diff sum squared x other index total diff < 0 0001 converged = iteration++ iteration % 100 == 0 out total diff to sum squared = 0 0 i = 0 i < training data size i++ instance instance = training data get i prediction = regression predict instance y = instance get target value residual = y prediction sum squared += residual residual builder out = builder out append + formatter format intercept index + index=0 index < dimension 1 index++ out append training data get data alphabet lookup index + out append formatter format index + out append s s e + formatter format sum squared + out to instance list data = instance list load 0 coordinate descent trainer = coordinate descent data parse 1 out trainer 
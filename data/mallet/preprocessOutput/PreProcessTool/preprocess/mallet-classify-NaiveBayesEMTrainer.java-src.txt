2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e classify io i o io input stream io output stream logging logger pipe pipe types alphabet types instance types instance list types multinomial logger author andrew mc callum <a href= mailto >mccallum edu< a> naive bayes e m trainer classifier trainer< naive bayes> logger logger = logger get logger m max ent trainer get name multinomial estimator feature estimator = multinomial laplace estimator multinomial estimator prior estimator = multinomial laplace estimator doc length normalization = 1 unlabeled data weight = 1 0 iteration = 0 naive bayes trainer factory nb trainer naive bayes classifier naive bayes e m trainer nb trainer = naive bayes trainer factory nb trainer set doc length normalization doc length normalization nb trainer set feature multinomial estimator feature estimator nb trainer set prior multinomial estimator prior estimator multinomial estimator get feature multinomial estimator feature estimator set feature multinomial estimator multinomial estimator me feature estimator = me nb trainer set feature multinomial estimator feature estimator multinomial estimator get prior multinomial estimator prior estimator set prior multinomial estimator multinomial estimator me prior estimator = me nb trainer set prior multinomial estimator prior estimator set doc length normalization d doc length normalization = d nb trainer set doc length normalization doc length normalization get doc length normalization doc length normalization get unlabeled data weight unlabeled data weight set unlabeled data weight unlabeled data weight unlabeled data weight = unlabeled data weight get iteration iteration finished training naive bayes get classifier classifier naive bayes train instance list training set get a classifier trained on labeled examples only naive bayes = naive bayes nb trainer classifier trainer train training set prev log likelihood = 0 log likelihood = 0 converged = iteration = 0 !converged make a training set that has some labels set instance list training set2 = instance list training set get pipe ii = 0 ii < training set size ii++ instance inst = training set get ii inst get labeling != training set2 add inst 1 0 instance inst2 = inst shallow copy inst2 un lock inst2 set labeling classify inst get labeling inst2 lock training set2 add inst2 unlabeled data weight = naive bayes nb trainer classifier trainer train training set2 log likelihood = data log likelihood training set2 err loglikelihood = +log likelihood wait a change in log likelihood less than 0 01% and at least 10 iterations math abs log likelihood prev log likelihood log likelihood < 0 0001 converged = prev log likelihood = log likelihood iteration++ to ret = naive bayes e m trainer doc length normalization != 1 0 ret += doc length normalization= +doc length normalization unlabeled data weight != 1 0 ret += unlabeled data weight= +unlabeled data weight ret serialization serial u overriden to prevent innocuous changes in from making serialization mechanism think external format has changed serial u = 1 u r r e n t s e r i a l v e r s i o n = 1 write output stream out i o out write u r r e n t s e r i a l v e r s i o n selections kind estimator used out write feature estimator out write prior estimator read input stream in i o not found = in read != u r r e n t s e r i a l v e r s i o n not found mismatched naive bayes trainer versions wanted + u r r e n t s e r i a l v e r s i o n + got + selections kind estimator used feature estimator = multinomial estimator in read prior estimator = multinomial estimator in read 
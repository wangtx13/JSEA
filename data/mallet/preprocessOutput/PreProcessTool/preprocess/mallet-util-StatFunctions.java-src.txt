2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e author andrew mc callum <a href= mailto >mccallum edu< a> logging obtained from stat vt ~sundar stat functions html august 2002 # stat functions d a m a g e 2000 sundar dorai raj author sundar dorai raj email sdoraira vt program free you can redistribute it and or modify it g n u general free foundation either 2 or at your option any later that any use properly credits author program distributed in hope that it will be useful but w i t h o u t a n y w a r r a n t y without even implied warranty m e r h a n t a b i l i t y or f i t n e s s f o r a p a r t i u l a r p u r p o s e g n u general more details at gnu io logger stat functions logger logger = logger get logger stat functions get name cov univariate x univariate y sumxy=0 i n= x size >=y size ? x size y size i=0 i<x size i++ sumxy+= x element at i x mean y element at i y mean index out bounds e logger info size x != size y e print stack trace sumxy n 1 corr univariate x univariate y cov=cov x y cov x stdev y stdev ols univariate x univariate y coef=new 2 i n= x size <=y size ? x size y size sxy=0 0 sxx=0 0 xbar=x mean ybar=y mean xi yi i=0 i<n i++ xi=x element at i yi=y element at i sxy+= xi xbar yi ybar sxx+= xi xbar xi xbar coef 0 =sxy sxx coef 1 =ybar coef 0 xbar coef qnorm p upper reference j d beasley and s g springer algorithm a s 111 percentage points normal applied statistics p<0 || p>1 illegal argument illegal argument +p+ qnorm p split=0 42 a0= 2 50662823884 a1= 18 61500062529 a2= 41 39119773534 a3= 25 44106049637 b1= 8 47351093090 b2= 23 08336743743 b3= 21 06224101826 b4= 3 13082909833 c0= 2 78718931138 c1= 2 29796479134 c2= 4 85014127135 c3= 2 32121276858 d1= 3 54388924762 d2= 1 63706781897 q=p 0 5 r ppnd math abs q <=split r=q q ppnd=q a3 r+a2 r+a1 r+a0 b4 r+b3 r+b2 r+b1 r+1 r=p q>0 r=1 p r>0 r= math sqrt math log r ppnd= c3 r+c2 r+c1 r+c0 d2 r+d1 r+1 q<0 ppnd= ppnd ppnd=0 upper ppnd=1 ppnd ppnd qnorm p upper mu sigma2 qnorm p upper math sqrt sigma2 +mu pnorm z upper reference i d hill algorithm a s 66 normal integral applied statistics ltone=7 0 utzero=18 66 con=1 28 a1 = 0 398942280444 a2 = 0 399903438504 a3 = 5 75885480458 a4 =29 8213557808 a5 = 2 62433121679 a6 =48 6959930692 a7 = 5 92885724438 b1 = 0 398942280385 b2 = 3 8052e 8 b3 = 1 00000615302 b4 = 3 98064794e 4 b5 = 1 986153813664 b6 = 0 151679116635 b7 = 5 29330324926 b8 = 4 8385912808 b9 =15 1508972451 b10= 0 742380924027 b11=30 789933034 b12= 3 99019417011 y alnorm z<0 upper=!upper z= z z<=ltone || upper z<=utzero y=0 5 z z z>con alnorm=b1 math exp y z b2+b3 z+b4+b5 z b6+b7 z+b8 b9 z+b10+b11 z+b12 alnorm=0 5 z a1 a2 y y+a3 a4 y+a5+a6 y+a7 alnorm=0 !upper alnorm=1 alnorm alnorm pnorm x upper mu sigma2 pnorm x mu math sqrt sigma2 upper qt p ndf lower tail algorithm 396 student s t quantiles g w hill a m 13 10 619 620 october 1970 p<=0 || p>=1 || ndf<1 illegal argument invalid p or df in call to qt eps=1e 12 m p i 2=1 570796326794896619231321691640 pi 2 neg p q prob a b d y x lower tail p > 0 5 || !lower tail p < 0 5 neg = p = 2 lower tail ? 1 p p neg = p = 2 lower tail ? p 1 p math abs ndf 2 < eps df ~= 2 q = math sqrt 2 p 2 p 2 ndf < 1 + eps df ~= 1 prob = p m p i 2 q = math cos prob math sin prob usual including e g df = 1 1 a = 1 ndf 0 5 b = 48 a a = 20700 a b 98 a 16 a + 96 36 d = 94 5 b + 3 b + 1 math sqrt a m p i 2 ndf y = math pow d p 2 ndf y > 0 05 + a asymptotic inverse expansion about normal x = qnorm 0 5 p y = x x ndf < 5 += 0 3 ndf 4 5 x + 0 6 = 0 05 d x 5 x 7 x 2 x + b + y = 0 4 y + 6 3 y + 36 y + 94 5 y 3 b + 1 x y = a y y y > 0 002 f i x m e cutoff precision dependent y = math exp y 1 taylor e^y 1 y = 0 5 y + 1 y y = 1 ndf + 6 ndf y 0 089 d 0 822 ndf + 2 3 + 0 5 ndf + 4 y 1 ndf + 1 ndf + 2 + 1 y q = math sqrt ndf y neg q = q q pt t df a l g o r i t h m a s 3 a p p l s t a t i s t 1968 v o l 17 p 189 computes p t<t a b idf im2 ioe s ks fk k g1=0 3183098862 =1 pi df<1 illegal argument illegal argument df pt t df idf=df a=t math sqrt idf b=idf idf+t t im2=df 2 ioe=idf%2 s=1 c=1 idf=1 ks=2+ioe fk=ks im2>=2 k=ks k<=im2 k+=2 c=c b fk 1 fk s+=c s!=idf idf=s fk+=2 ioe!=1 0 5+0 5 a math sqrt b s df==1 s=0 0 5+ a b s+ math atan a g1 pchisq q df posten h 1989 american statistician 43 p 261 265 df2=df 5 q2=q 5 n=5 k tk f l f u prob q<=0 || df<=0 illegal argument illegal argument +q+ or +df+ qnorm p q<df tk=q2 1 n df2 df2+2 n 1+n q2 df2+2 n k=n 1 k>1 k tk=q2 1 k df2 df2+2 k 1+k q2 df2+2 k+tk f l=1 q2 df2+1+q2 df2+2+tk prob= math exp df2 math log q2 q2 maths log gamma df2+1 math log f l tk= n df2 q2+n k=n 1 k>1 k tk= k df2 q2+k 1+tk f u=1+ 1 df2 q2+1 1+tk prob=1 math exp df2 1 math log q2 q2 maths log gamma df2 math log f u prob betainv x p q a l g o r i t h m a s 63 a p p l s t a t i s t v o l 32 n o 1 computes p beta>x beta= maths log beta p q acu=1 e 14 cx psq pp qq x2 term ai betain ns rx temp indx p<=0 || q<=0 1 0 x<=0 || x>=1 1 0 psq=p+q cx=1 x p<psq x x2=cx cx=x pp=q qq=p indx=true x2=x pp=p qq=q indx=false term=1 ai=1 betain=1 ns=qq+cx psq rx=x2 cx temp=qq ai ns==0 rx=x2 temp>acu temp>acu betain term=term temp rx pp+ai betain=betain+term temp= math abs term temp>acu temp>acu betain ai++ ns ns>=0 temp=qq ai ns==0 rx=x2 temp=psq psq+=1 betain = math exp pp math log x2 + qq 1 math log cx beta pp indx betain=1 betain betain pf x df1 df2 a l g o r i t h m a s 63 a p p l s t a t i s t v o l 32 n o 1 computes p f>x betainv df1 x df1 x+df2 0 5 df1 0 5 df2 
2002 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e difference between constraint and expectation each feature on correct author andrew mc callum <a href= mailto >mccallum edu< a> types io classify classification gradient gain ranked feature vector gradient gain a feature f defined in max ent type feature+class feature s f f = f graident gain a feature f g f = g f = abs e~ f e f where e~ empirical according to label and e from imperfect classifier gradient gain a feature f g f = sum g f calc gradient gains instance list ilist label vector classifications num instances = ilist size num classes = ilist get target alphabet size num features = ilist get data alphabet size gradientgains = num features flv feature location value fli feature location index populate target feature count et al i = 0 i < ilist size i++ classifications i get label alphabet == ilist get target alphabet instance inst = ilist get i labeling labeling = inst get labeling feature vector fv = feature vector inst get data instance weight = ilist get instance weight i below relies on label weights summing to 1 over all labels! label weight sum = 0 ll = 0 ll < labeling num locations ll++ = labeling index at location ll label weight = labeling value label weight sum += label weight label weight diff = math abs label weight classifications i value fl = 0 fl < fv num locations fl++ fli = fv index at location fl gradientgains fli += fv value at location fl label weight diff instance weight math abs label weight sum 1 0 < 0 0001 gradientgains gradient gain instance list ilist label vector classifications ilist get data alphabet calc gradient gains ilist classifications label vector get label vectors from classifications classification label vector ret = label vector length i = 0 i < length i++ ret i = i get label vector ret gradient gain instance list ilist classification classifications ilist get data alphabet calc gradient gains ilist get label vectors from classifications classifications factory ranked feature vector factory label vector classifications factory label vector classifications classifications = classifications ranked feature vector ranked feature vector instance list ilist gradient gain ilist classifications serialization serial u = 1 u r r e n t s e r i a l v e r s i o n = 0 write output stream out i o out write u r r e n t s e r i a l v e r s i o n out write classifications length i = 0 i < classifications length i++ out write classifications i read input stream in i o not found = in read n = in read classifications = label vector n i = 0 i < n i++ classifications i = label vector in read 
regression arrays io text number format types optimize linear regression trainer optimizable gradient value linear regression regression instance list training data residuals cached residuals stale = number format formatter precision index intercept index linear regression trainer instance list data training data = data regression = linear regression training data get data alphabet = regression get intercept index = length 2 precision index = length 1 residuals = training data size 0 = math log math random intercept index = 7 0 math log math random precision index = 1 0 formatter = number format get instance formatter set maximum fraction digits 3 compute residuals i = 0 i < training data size i++ instance instance = training data get i residuals i = instance get target value out print residuals i feature vector predictors = feature vector instance get data location = 0 location < predictors num locations location++ index = predictors index at location location residuals i = index predictors value at location location out print + formatter format index + + formatter format predictors value at location location add intercept term residuals i = intercept index out + formatter format length 1 cached residuals stale = get value parameter = 0 parameter < length parameter++ out parameter out log likelihood = 0 0 log likelihood += residuals length 2 0 math log precision index cached residuals stale compute residuals compute residuals i = 0 i < residuals length i++ log likelihood = precision index precision index residuals i residuals i 2 0 gaussian prior on non intercept parameter = 0 parameter < length 1 parameter++ log likelihood = parameter parameter 2 0 log likelihood get value gradient gradient cached residuals stale compute residuals compute residuals arrays fill gradient 0 0 gradient precision index += 0 5 residuals length precision index i = 0 i < residuals length i++ instance instance = training data get i feature vector predictors = feature vector instance get data location = 0 location < predictors num locations location++ index = predictors index at location location index == 3 gradient index += precision index precision index residuals i predictors value at location location out gradient index + + formatter format residuals i + + formatter format predictors value at location location + = + formatter format residuals i predictors value at location location gradient intercept index += precision index precision index residuals i gradient precision index = precision index residuals i residuals i include a zero mean gaussian prior on all except intercept term parameter = 0 parameter < length 1 parameter++ gradient parameter = parameter parameter = 0 parameter < length parameter++ out g + gradient parameter + + parameter out following get set satisfy optimizable get num length get parameter i i get buffer i=0 i < length i++ buffer i = i set parameter i r i == precision index r <= 0 0 err attempted to set precision at or less than 0 r = 0 001 cached residuals stale = i = r set cached residuals stale = i=0 i< length i++ i == precision index i <= 0 0 err attempted to set precision at or less than 0 i = 0 001 i = i instance list data = instance list load 0 linear regression trainer trainer = linear regression trainer data optimizer optimizer = orthant wise limited memory b f g s trainer optimizer optimizer = limited memory b f g s trainer optimizer optimize optimizer optimize 
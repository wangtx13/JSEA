cluster tui io buffered writer io io input stream io output stream io writer io input stream io output stream list logging logger classify classifier classify max ent trainer classify trial cluster clusterer cluster clustering cluster clusterings cluster greedy agglomerative density cluster record cluster evaluate accuracy evaluator cluster evaluate b cubed evaluator cluster evaluate clustering evaluator cluster evaluate clustering evaluators cluster evaluate m u evaluator cluster evaluate pair f1 evaluator cluster iterator pair sample iterator cluster neighbor evaluator agglomerative neighbor cluster neighbor evaluator neighbor evaluator cluster neighbor evaluator pairwise evaluator pipe pipe types alphabet types feature vector types info gain types instance types instance list types label alphabet command option logger property list randoms strings in progresspublic clusterings2 clusterer logger logger = logger get logger clusterings2 clusterer get name command option set summary clusterings2 clusterer a tool to train and test a clusterer command option process clusterings2 clusterer t r a i n randoms random = randoms 123 clusterer clusterer = !load clusterer value clusterings training = read clusterings training value alphabet field alphabet = record training get 0 get instances get 0 get data field alphabet pipe pipe = clustering pipe string2ints exact match fields value field alphabet string2ints approx match fields value field alphabet string2ints substring match fields value field alphabet instance list training instances = instance list pipe i = 0 i < training size i++ pair sample iterator iterator = pair sample iterator training get i random 0 5 training get i get num instances iterator has next instance inst = iterator next training instances add pipe pipe inst logger info generated + training instances size + training instances classifier classifier = max ent trainer train training instances logger info info gain info gain training instances print rank out logger info pairwise training accuracy= + trial classifier training instances get accuracy neighbor evaluator neval = pairwise evaluator classifier y e s pairwise evaluator average clusterer = greedy agglomerative density training get 0 get instances get pipe neval 0 5 random training = training instances = input stream ois = input stream input stream load clusterer value clusterer = clusterer ois read t e s t clusterings testing = read clusterings testing value clustering evaluator evaluator = clustering evaluator clustering evaluator option value evaluator == evaluator = clustering evaluators clustering evaluator b cubed evaluator pair f1 evaluator m u evaluator accuracy evaluator list< clustering> predictions = list< clustering> i = 0 i < testing size i++ clustering clustering = testing get i clustering predicted = clusterer cluster clustering get instances predictions add predicted logger info evaluator evaluate clustering predicted logger info evaluator evaluate totals w r i t e o u t p u t output stream oos = output stream output stream save clusterer value oos write clusterer oos close output clusterings value != buffered writer writer = buffered writer writer output clusterings value writer write predictions to writer flush writer close string2ints ss alphabet alph ret = ss length i = 0 i < ss length i++ ret i = alph lookup index ss i ret clusterings read clusterings f input stream ois = input stream input stream f clusterings ois read command option load clusterer = command option clusterings2 clusterer load clusterer f i l e from which to read clusterer command option save clusterer = command option clusterings2 clusterer save clusterer f i l e clusterer filename in which to write clusterer after it has been trained command option output clusterings = command option clusterings2 clusterer output clusterings f i l e n a m e predictions filename in which to write predicted clusterings command option training = command option clusterings2 clusterer train f i l e n a m e text clusterings train read training set clusterings from + specified input parameter ignored command option testing = command option clusterings2 clusterer test f i l e n a m e text clusterings test read test set clusterings from + option specified training parameter must be specified and + input parameter ignored command option clustering evaluator option = command option clusterings2 clusterer clustering evaluator o n s t r u t o r constructing a clustering evaluator command option spaced strings exact match fields = command option spaced strings clusterings2 clusterer exact match fields s t r i n g field names to be checked exactly matching values command option spaced strings approx match fields = command option spaced strings clusterings2 clusterer approx match fields s t r i n g field names to be checked approx matching values command option spaced strings substring match fields = command option spaced strings clusterings2 clusterer substring match fields s t r i n g field names to be checked substring matching values note that values fewer than 3 characters are ignored clustering pipe pipe serial u = 1 l exact match fields approx match fields substring match fields approx match threshold clustering pipe exact match fields approx match fields substring match fields alphabet label alphabet exact match fields = exact match fields approx match fields = approx match fields substring match fields = substring match fields record array2 records a instance list list list< record> records = list< record> i = 0 i < a length i++ records add record list get a i get data record records to record instance pipe instance carrier agglomerative neighbor neighbor = agglomerative neighbor carrier get data clustering original = neighbor get original cluster1 = neighbor get old clusters 0 cluster2 = neighbor get old clusters 1 instance list list = original get instances merged indices = neighbor get cluster record records = array2 records merged indices list alphabet field alph = records 0 field alphabet alphabet value alph = records 0 value alphabet property list features = features = add exact match records field alph value alph features features = add approx match records field alph value alph features features = add substring match records field alph value alph features carrier set data feature vector get data alphabet features label alphabet ldict = label alphabet get target alphabet label = original get label cluster1 0 == original get label cluster2 0 ? y e s n o carrier set target ldict lookup label label carrier property list add exact match record records alphabet field alph alphabet value alph property list features fi = 0 fi < exact match fields length fi++ matches = 0 comparisons = 0 i = 0 i < records length exact match fields length > 0 i++ feature vector valsi = records i values exact match fields fi j = i + 1 j < records length valsi != j++ feature vector valsj = records j values exact match fields fi valsj != comparisons++ ii = 0 ii < valsi num locations ii++ valsj contains value alph lookup valsi index at location ii matches++ matches == comparisons comparisons > 1 features = property list add field alph lookup exact match fields fi + all match 1 0 features matches > 0 features = property list add field alph lookup exact match fields fi + match 1 0 features features property list add approx match record records alphabet field alph alphabet value alph property list features fi = 0 fi < approx match fields length fi++ matches = 0 comparisons = 0 i = 0 i < records length approx match fields length > 0 i++ feature vector valsi = records i values approx match fields fi j = i + 1 j < records length valsi != j++ feature vector valsj = records j values approx match fields fi valsj != comparisons++ ii = 0 ii < valsi num locations ii++ si = value alph lookup valsi index at location ii jj = 0 jj < valsj num locations jj++ sj = value alph lookup valsj index at location jj strings levenshtein distance si sj < approx match threshold matches++ matches == comparisons comparisons > 1 features = property list add field alph lookup approx match fields fi + all approx match 1 0 features matches > 0 features = property list add field alph lookup approx match fields fi + approx match 1 0 features features property list add substring match record records alphabet field alph alphabet value alph property list features fi = 0 fi < substring match fields length fi++ matches = 0 comparisons = 0 i = 0 i < records length substring match fields length > 0 i++ feature vector valsi = records i values substring match fields fi j = i + 1 j < records length valsi != j++ feature vector valsj = records j values substring match fields fi valsj != comparisons++ ii = 0 ii < valsi num locations ii++ si = value alph lookup valsi index at location ii si length < 2 jj = 0 jj < valsj num locations jj++ sj = value alph lookup valsj index at location jj sj length > 2 si contains si || sj contains si matches++ matches == comparisons comparisons > 1 features = property list add field alph lookup exact match fields fi + all substring match 1 0 features matches > 0 features = property list add field alph lookup exact match fields fi + substring match 1 0 features features 
regression arrays io text number format types optimize m v normal stat functions least squares linear regression regression instance list training data residuals mean squared = 0 0 sum squared sum squared model degrees freedom number format formatter precision index intercept index dimension x transpose x inverse least squares instance list data data 0 0 least squares instance list data regularization training data = data regression = linear regression training data get data alphabet = regression get intercept index = length 2 precision index = length 1 residuals = training data size formatter = number format get instance formatter set maximum fraction digits 8 we re not concerned precision variable dimension = length 1 x transpose x = dimension dimension x transpose y = dimension mean y = 0 0 instance instance data feature vector predictors = feature vector instance get data y = instance get target value mean y += y i = 0 i < predictors num locations i++ index1 = predictors index at location i value1 = predictors value at location i j = 0 j < predictors num locations j++ index2 = predictors index at location j value2 = predictors value at location j x transpose x dimension index1 + index2 += value1 value2 handle off diagonal intercept x transpose x dimension index1 + intercept index += value1 x transpose x dimension intercept index + index1 += value1 now x y x transpose y index1 += value1 y intercept term counts instances x transpose x dimension intercept index + intercept index ++ x transpose y intercept index += y l2 regularized regression aka ridge regression regularization > 0 0 d = 0 d < dimension d++ x transpose x dimension d + d += regularization mean y = data size x transpose x inverse = m v normal invert s p d x transpose x dimension one over n squared = 1 0 data size data size now multiply matrix x x^ 1 vector x y index1 = 0 index1 < dimension index1++ index2 = 0 index2 < dimension index2++ index1 += x transpose x inverse index1 dimension + index2 x transpose y index2 compute residuals and mean squared sum squared = 0 0 sum squared model = 0 0 degrees freedom = training data size dimension i = 0 i < training data size i++ instance instance = training data get i prediction = regression predict instance y = instance get target value residuals i = y prediction sum squared += residuals i residuals i sum squared model += mean y prediction mean y prediction mean squared = sum squared degrees freedom p values values = dimension index=0 index < dimension index++ standard = math sqrt mean squared x transpose x inverse dimension index + index values index = 2 1 0 stat functions pt math abs index standard degrees freedom values print a summary regression similar to summary lm in r print summary standard t percentile out std err t value pr >|t| out print out print formatter format intercept index + standard = math sqrt mean squared x transpose x inverse dimension intercept index + intercept index out print formatter format standard + out print formatter format intercept index standard + t percentile = 2 1 0 stat functions pt math abs intercept index standard degrees freedom out formatter format t percentile + + significance stars t percentile index=0 index < dimension 1 index++ out print training data get data alphabet lookup index + out print formatter format index + standard = math sqrt mean squared x transpose x inverse dimension index + index out print formatter format standard + out print formatter format index standard + t percentile = 2 1 0 stat functions pt math abs index standard degrees freedom out formatter format t percentile + + significance stars t percentile out out s s e + formatter format sum squared + d f + degrees freedom out r^2 + formatter format sum squared model sum squared + sum squared model significance stars p p < 0 001 p < 0 01 p < 0 05 p < 0 1 get num length get parameter i i get buffer i=0 i < length i++ buffer i = i linear regression get regression regression instance list data = instance list load 0 least squares ls = length > 1 ls = least squares data parse 1 ls = least squares data ls print summary 
2006 m a l l e t m achine languag e ~mccallum 1 0 further ` l i e n s e types gnu trove t list gnu trove t hash map gnu trove t hash map io serializable io output stream io i o io input stream list list a global mapping between variables and indices all variables belong to exactly one universe $ universe v 1 1 2007 10 22 21 37 44 exp $ universe serializable bidirectional map variable alphabet universe d e f a u l t = universe universe variable alphabet = bidirectional map reset universe d e f a u l t = universe all projection caches = t hash map add variable var variable alphabet lookup index var variable get idx variable variable alphabet lookup idx get index variable var variable alphabet lookup index var size variable alphabet size serial u = 1 u r r e n t s e r i a l v e r s i o n = 1 write output stream out i o out write out write u r r e n t s e r i a l v e r s i o n out write variable alphabet to read input stream in i o not found in read = in read vars = in read variable alphabet = bidirectional map vars length vi = 0 vi < vars length vi++ add variable vars vi maintaining global projection caches can get dangerous variables are thrown away willy nilly in test cases cas t hash map all projection caches = t hash map t hash map lookup projection cache var set var set list sizes = list var set size vi = 0 vi < var set size vi++ sizes add var set get vi get num outcomes t hash map result = t hash map all projection caches get sizes result == result = t hash map all projection caches put sizes result result 
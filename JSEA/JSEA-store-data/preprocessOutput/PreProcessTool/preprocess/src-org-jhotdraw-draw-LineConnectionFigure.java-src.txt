# bezi bezi line connection 1 0 1 2006 02 06 1996 2006 contributor right reserve thi disclose accordance term enter draw geom undo io geom xml dom input xml dom output line connection standard connection figure implement bezi figure wern randelshof 1 0 1 2006 02 06 fix redo 1 0 23 januar 2006 create line connection figure extend line figure implement connection figure connector start connector connector end connector liner liner handle figure change start end figure connection handler connection handler connection handler thi connection handler implement figure listener line connection figure owner connection handler line connection figure owner thi owner owner figure request remove figure e figure remove figure evt comment line below stay comment out thi because we set our connector order support reconnection using redo evt get figure owner get start figure || evt get figure owner get end figure owner set start connector owner set end connector owner fire figure request remove figure change figure e e get owner get start figure || e get owner get end figure owner change owner update connection owner change figure add figure e figure attribute change figure e figure area invalidate figure e create instance line connection figure d r i n g s h p e n d b o u n d s ensure connection update connection wa move basic transform affine transform tx basic transform tx update connection make sure we are still connect t t r i b u t e s e d i t i n g get handle figure normal polyline handle add change connection handle at start end collection handle create handle detail level list handle handle list handle get node count detail level 0 get liner i 1 n get node count 1 i n i++ handle add bezi node handle thi i handle add change connection start handle thi handle add change connection end handle thi handle o n n e t i n g test wheth figure connection target connection figure cannot connect connect update connection change get start connector point2 d start get start connector find start thi start basic set start point start get end connector point2 d end get end connector find end thi end basic set end point end change validate validate lineout connect figure start figure end start connect end connect connect same connection figure other other get start connector get start connector other get end connector get end connector connector get end connector end connector figure get end figure end connector ? end connector get owner connector get start connector start connector figure get start figure start connector ? start connector get owner note thi testing purpose remove keywoard at time set end connector connector end connector old end end connector end old end change basic set end connector end fire undoable edit happen undoable edit get presentation end verbindung setzen undo cannot undo undo change basic set end connector old end change redo cannot undo redo change basic set end connector end change change protect basic set end connector connector end end end connector end connector get end figure remove figure listener connection handler get start figure handle disconnect get start figure get end figure end connector end end connector get end figure add figure listener connection handler get start figure get end figure handle connect get start figure get end figure update connection note thi testing purpose remove keywoard at time set start connector connector start connector old start start connector start old start change basic set start connector start fire undoable edit happen undoable edit get presentation start verbindung setzen undo cannot undo undo change basic set start connector old start change redo cannot undo redo change basic set start connector start change change basic set start connector connector start start start connector start connector get start figure remove figure listener connection handler get end figure handle disconnect get start figure get end figure start connector start start connector get start figure add figure listener connection handler get start figure get end figure handle connect get start figure get end figure update connection o m p o s i t e f i g u r e s l y o u t liner get bezi path layout liner get attribute b e z i e r p t h l y o u t e r set bezi path layout liner value set attribute b e z i e r p t h l y o u t e r value lay out connection thi call when connection itself change connection recalculate layout connection get start connector get end connector change liner bpl get bezi path layout bpl bpl lineout thi get start connector point2 d start get start connector find start thi start basic set start point start get end connector point2 d end get end connector find end thi end basic set end point end change l o n i n g e v e n t h n d l i n g add notify add notify get start connector get end connector handle connect get start figure get end figure remove notify set start connector set end connector get start connector get end connector handle disconnect get start figure get end figure remove notify handle disconnection connection override thi handle thi protect handle disconnect figure start figure end handle connection connection override thi handle thi protect handle connect figure start figure end line connection figure clone line connection figure line connection figure clone connection handler connection handler thi liner liner liner thi liner clone share same connector thi ha work properly register figure listener connect figure thi start connector start connector connector thi start connector clone get start figure add figure listener connection handler thi end connector end connector connector thi end connector clone get end figure add figure listener connection handler start connector end connector handle connect get start figure get end figure update connection remap map old change remap old figure start figure figure end figure get start figure start figure figure old get get start figure start figure start figure get start figure get end figure end figure figure old get get end figure end figure end figure get end figure start figure set start connector start figure find compatible connector get start connector end figure set end connector end figure find compatible connector get end connector update connection change connect figure start start connect handle mouse click handle mouse click point2 d p mouse evt view view get liner evt get click count 2 change index basic split segment p 5f view get scale factor index 1 bezi path node node get node index fire undoable edit happen undoable edit redo cannot redo redo change basic add node index node change undo cannot undo undo change basic remove node index change change p e r s i s t e n e protect read point dom input i o read point open element start connector set start connector connector read close element open element end connector set end connector connector read close element read dom input i o read point read attribute read liner protect read liner dom input i o get element count liner 0 open element liner liner liner read close element write dom output out i o write point out write attribute out write liner out protect write liner dom output out i o liner out open element liner out write liner out close element protect write point dom output out i o write point out out open element start connector out write get start connector out close element out open element end connector out write get end connector out close element set liner liner value change thi liner value change basic set node index bezi path node p index 0 index get point count 1 get start connector point2 d start get start connector find start thi start basic set start point start get end connector point2 d end get end connector find end thi end basic set end point end basic set node index p basic set point index point2 d p index 0 index get point count 1 get start connector point2 d start get start connector find start thi start basic set start point start get end connector point2 d end get end connector find end thi end basic set end point end basic set point index p lineout liner liner lineout thi f i x m e liner work p i line connection bezi path get bezi path path liner get liner liner set start point point2 d p set point 0 p set point index point2 d p set point index 0 p set end point point2 d p set point get point count 1 p reverse connection start connector end connector handle disconnect start connector get owner end connector get owner connector tmp start connector start connector end connector end connector tmp point2 d tmp p get start point set start point get end point set end point tmp p handle connect start connector get owner end connector get owner update connection 
std xml reader nano xml $ revision 1 4 $ $ date 2002 01 04 21 03 28 $ $ name r e l e a s e 2 2 1 $ is part of nano xml 2 copyright c 2000 2002 marc de scheemaeck all right reserve software is provide a is without any express or imply warranty in no event will the author be hold liable any damage arise from the use of software permission is grant to anyone to use software any purpose include commercial application and to alter it and redistribute it freely subject to the following restriction 1 the origin of software must not be misrepresent you must not claim that you write the original software you use software in a product an acknowledgment in the product documentation would be appreciate but is not require 2 alter source version must be plainly mark a such and must not be misrepresent a being the original software 3 notice may not be remove or alter from any source distribution net n3 nanoxml io input stream io input stream reader io i o io io input stream io not found io line number reader io pushback reader io pushback input stream io reader io reader io unsupport encoding net malform u r l net u r l stack std xml reader read the data to be parse author marc de scheemaeck $ name r e l e a s e 2 2 1 $ $ revision 1 4 $ std xml reader i xml reader a stack reader author marc de scheemaeck $ name r e l e a s e 2 2 1 $ $ revision 1 4 $ stack reader pushback reader pb reader line number reader line reader u r l the stack of reader stack reader the current push back reader stack reader current reader create a reader using a a input str the contain the xml data i xml reader reader str std xml reader reader str create a reader using a a input filename the name of the contain the xml data io not found the could not be found io i o an i o occur i xml reader reader filename not found i o std xml reader r std xml reader input stream filename r set filename i 0 i r reader size i++ stack reader sr stack reader r reader element at i sr r current reader r initializ the reader from a and the which may be the non malform u r l the doe not contain a valid u r l not found the refer to a local which doe not i o an occur opening the stream std xml reader malform u r l not found i o u r l ida u r l ida u r l u r l malform u r l e + ida u r l u r l malform u r l e2 e current reader stack reader reader stack reader reader open stream ida u r l to current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 initializ the xml reader reader the input the xml data std xml reader reader reader current reader stack reader reader stack current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 current reader current reader u r l malform u r l e nev happen clean up the when it s destroy finalize throwable current reader line reader current reader pb reader current reader current reader current reader reader clear finalize scan the encoding from an lt ?xml ? tag str the first tag in the xml data the encoding or no encoding ha be specify get encoding str str start with ?xml index 5 index str length buffer key buffer index str length str at index index++ index str length str at index a str at index z key append str at index index++ index str length str at index index++ index str length || str at index index str length str at index \ str at index index++ index str length delimit str at index index++ index2 str index of delimit index index2 0 key to equal encoding str substring index index2 index index2 + 1 convert a stream to a reader detecting the encoding stream the input the xml data char read buffer where to put character that have be read io i o an i o occur reader stream2read input stream stream buffer char read i o pushback input stream pbstream pushback input stream stream b pbstream read b 0x00 0x f e 0x f f pbstream unread b input stream reader pbstream u t f 16 0x e f i 0 i 2 i++ pbstream read input stream reader pbstream u t f 8 0x3 c b pbstream read char read append b 0 b 0x3 e char read append b b pbstream read b 0 char read append b encoding get encoding char read to encoding input stream reader pbstream u t f 8 char read set length 0 input stream reader pbstream encoding unsupport encoding e input stream reader pbstream u t f 8 char read append b input stream reader pbstream u t f 8 initializ the xml reader stream the input the xml data io i o an i o occur std xml reader input stream stream i o pushback input stream pbstream pushback input stream stream buffer char read buffer reader reader stream2read stream char read current reader stack reader reader stack current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 current reader current reader u r l malform u r l e nev happen start stream reader char read to read a character the character io i o no character could be read read i o ch current reader pb reader read ch 0 reader empty i o unexpect e o f current reader pb reader close current reader stack reader reader pop ch current reader pb reader read ch the current stream ha no more character left to be read io i o an i o occur at e o f of current stream i o ch current reader pb reader read ch 0 current reader pb reader unread ch there are no more character left to be read io i o an i o occur at e o f i o ch current reader pb reader read ch 0 reader empty current reader pb reader close current reader stack reader reader pop ch current reader pb reader read current reader pb reader unread ch push the last character read back to the stream ch the character to push back io i o an i o occur unread ch i o current reader pb reader unread ch open a stream from a and the which may be the which is nev net malform u r l the doe not contain a valid u r l io not found the refer to a local which doe not io i o an occur opening the stream reader open stream malform u r l not found i o u r l url u r l current reader url get ref ref url get ref url get length 0 url u r l url get protocol url get host url get port url get url u r l jar + url + + ref url std xml reader get resource ref current reader current reader url buffer char read buffer reader reader stream2read url open stream char read char read length 0 reader char read str char read to pushback reader pbread pushback reader reader char read str length i char read str length 1 i 0 i pbread unread char read str at i pbread start a stream from a reader the stream is use temporary to read data from that stream is exhaust control to the parent stream reader the non reader to read the data from start stream reader reader start stream reader start a stream from a reader the stream is use temporary to read data from that stream is exhaust control to the parent stream reader the non reader to read the data from is internal entity the reader is produce by resolving an internal entity start stream reader reader is internal entity stack reader old reader current reader reader push current reader current reader stack reader is internal entity current reader line reader current reader pb reader pushback reader reader 2 current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 current reader old reader current reader old reader the current level of the stream on the stack of stream get stream level reader size the line number of the data in the current stream get line nr current reader line reader stack reader sr stack reader reader peek sr line reader 0 sr line reader get line number + 1 current reader line reader get line number + 1 set the of the current stream the net malform u r l the doe not contain a valid u r l set malform u r l current reader u r l current reader set the of the current stream the set current reader the current get current reader to the current get current reader 
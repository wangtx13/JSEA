# bezi scale handle 1 0 16 juni 2006 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org org jhotdraw draw org jhotdraw org jhotdraw undo event geom org jhotdraw geom a handle to scale and rotate a bezi figure pressing the alt key or the shift key manipulate the handle restrict the handle to only rotate the bezi figure author wern randelshof 1 0 16 juni 2006 create bezi scale handle handle point location restore data affine transform transform point2 d center start theta start length create a instance bezi scale handle bezi figure owner owner is combinable with handle h draw handle draw graphics2 d g draw circle g color yellow color black rectangle basic get bound rectangle r rectangle get location r grow get handlesize 2 get handlesize 2 r point get location location location view drawing to view get origin location bezi figure get bezi figure bezi figure get owner point2 d get origin find a nice place to put handle need to pick a place that will not overlap with point handle and is internal to polygon handlesize get handlesize one handlesize step away from outermost toward center point2 d out get bezi figure get outermost point point2 d ctr get bezi figure get center len geom length out x out y ctr x ctr y len 0 best we can do? point2 d out x handlesize 2 out y + handlesize 2 u handlesize len u 1 0 best we can do? point2 d out x 3 + ctr x 4 out y 3 + ctr y 4 point2 d out x 1 0 u + ctr x u out y 1 0 u + ctr y u track start point anchor modifier ex location point anchor x anchor y restore data get bezi figure get restore data transform affine transform center get bezi figure get center point2 d anchor point view view to drawing anchor start theta geom angle center x center y anchor point x anchor point y start length geom length center x center y anchor point x anchor point y track step point anchor point modifier ex location point x y point2 d point view view to drawing step theta geom angle center x center y point x point y step length geom length center x center y point x point y scale factor modifier ex input event a l t d o w n m a s k | input event s h i f t d o w n m a s k 0 ? 1d step length start length transform set to identity transform translate center x center y transform scale scale factor scale factor transform rotate step theta start theta transform translate center x center y get owner will change get owner restore to restore data get owner basic transform transform get owner change scale rotate point anchor polygon original polygon point p will change use center to determine relative angle and length point ctr center original polygon anchor len geom length ctr x ctr y anchor x anchor y anchor len 0 0 len geom length ctr x ctr y p x p y ratio len anchor len anchor angle math atan2 anchor y ctr y anchor x ctr x angle math atan2 p y ctr y p x ctr x rotation angle anchor angle n original polygon npoint x n y n i 0 i n ++i x original polygon xpoint i y original polygon ypoint i l geom length ctr x ctr y x y ratio a math atan2 y ctr y x ctr x + rotation x i ctr x + l math co a + 0 5 y i ctr y + l math sin a + 0 5 set internal polygon polygon x y n change track end point anchor point modifier ex view get drawing fire undoable edit happen restore data edit get owner restore data location 
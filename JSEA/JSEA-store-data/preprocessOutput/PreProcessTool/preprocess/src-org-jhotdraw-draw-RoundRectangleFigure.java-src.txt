# round rectangle figure 2 2 2006 06 17 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org org jhotdraw draw geom io undo org jhotdraw draw attribute key org jhotdraw geom org jhotdraw xml dom input org jhotdraw xml dom output a rectangle2 d with round corner author wern randelshof 2 2 2006 06 17 chop add 2 1 2006 05 29 basic set bound do not work bound small than 1 pixel 2 0 2006 01 14 change to support coordinate 1 0 2004 03 02 derive from jhotdraw 6 0b1 round rectangle figure attribute figure round rectangle2 d roundrect d e f a u l t a r c 20 create a instance round rectangle figure 0 0 0 0 round rectangle figure x y width height roundrect round rectangle2 d x y width height d e f a u l t a r c d e f a u l t a r c f i l l c o l o r set color white s t r o k e c o l o r set color black rectangle2 d get bound rectangle2 d roundrect get bounds2 d rectangle2 d get figure draw bound rectangle2 d r rectangle2 d roundrect get bounds2 d grow attribute key get perpendicular hit growth geom grow r grow grow r get arc width roundrect arcwidth get arc height roundrect archeight set arc w h old width roundrect get arc width old height roundrect get arc height roundrect arcwidth w roundrect archeight h fire figure change get draw bound fire undoable edit happen undoable edit get presentation name rundung undo cannot undo undo will change roundrect arcwidth old width roundrect archeight old height change redo cannot redo redo will change roundrect arcwidth w roundrect archeight h change draw fill graphics2 d g round rectangle2 d r round rectangle2 d roundrect clone grow attribute key get perpendicular fill growth r x grow r y grow r width + grow 2 r height + grow 2 r arcwidth + grow 2 r archeight + grow 2 r width 0 r height 0 g fill r draw stroke graphics2 d g round rectangle2 d r round rectangle2 d roundrect clone grow attribute key get perpendicular draw growth r x grow r y grow r width + grow 2 r height + grow 2 r arcwidth + grow 2 r archeight + grow 2 r width 0 r height 0 g draw r check a point2 d is inside the figure contain point2 d p round rectangle2 d r round rectangle2 d roundrect clone grow attribute key get perpendicular hit growth r x grow r y grow r width + grow 2 r height + grow 2 r arcwidth + grow 2 r archeight + grow 2 r contain p basic set bound point2 d anchor point2 d roundrect x math min anchor x x roundrect y math min anchor y y roundrect width math max 0 1 math ab x anchor x roundrect height math max 0 1 math ab y anchor y transform the figure tx the transformation basic transform affine transform tx point2 d anchor get start point point2 d get end point basic set bound point2 d tx transform anchor anchor point2 d tx transform collection handle create handle detail level link list handle handle link list handle create handle detail level handle add round rect radius handle handle connector find connector point2 d p connection figure prototype chop round rect connector connector find compatible connector connector c is start connector chop round rect connector round rectangle figure clone round rectangle figure that round rectangle figure clone that roundrect round rectangle2 d roundrect clone that override read dom input in i o read in roundrect arcwidth in get attribute arc width d e f a u l t a r c roundrect archeight in get attribute arc height d e f a u l t a r c override write dom output out i o write out out add attribute arc width roundrect arcwidth out add attribute arc height roundrect archeight restore to geometry round rectangle2 d r round rectangle2 d geometry roundrect x r x roundrect y r y roundrect width r width roundrect height r height get restore data roundrect clone point2 d chop point2 d from rectangle2 d out get bound grow s t r o k e p l a c e m e n t get c e n t e r grow attribute key get stroke total width 2 o u t s e grow attribute key get stroke total width i n s e grow 0 out x grow out y grow out width + grow 2 out height + grow 2 rectangle2 d inner rectangle2 d out clone gw get arc width + grow 2 2 gh get arc height + grow 2 2 inner x gw inner y gh inner width + gw 2 inner height + gh 2 angle geom point to angle out from point2 d p geom angle to point out geom point to angle out from p x out x || p x out x + out width p y math min math max p y inner y inner y + inner height p x math min math max p x inner x inner x + inner width p 
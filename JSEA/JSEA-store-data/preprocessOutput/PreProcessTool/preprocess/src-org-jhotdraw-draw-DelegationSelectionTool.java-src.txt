# delegation selection tool 2 0 2006 02 21 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org ??? org jhotdraw draw geom event org jhotdraw app action action a selection tool which recogniz click and popup menu trigger a click or popup trigger is encounter a hook is call which handle the event can be overriden in subclasse to provide customize behaviour p by tool delegate mouse event to a specific tool the figure which ha be click provide a specialize tool author wern randelshof 2 0 2006 01 18 change to support precision coordinate popup timer add support radio button menu item add 1 0 2003 12 01 derive from jhotdraw 5 4b1 delegation selection tool selection tool a set of action which is apply to the drawing collection action drawing action a set of action which is apply to a selection of figure collection action selection action we use timer to show a popup menu when the user press the mouse key a second without move the mouse timer popup timer when the popup menu is visible we not track mouse movement j popup menu popup menu create a instance delegation selection tool link list action link list action create a instance delegation selection tool collection action drawing action collection action selection action drawing action drawing action selection action selection action set drawing action collection action drawing action drawing action drawing action set figure action collection action selection action selection action selection action mouse listener mouse press event the popup trigger ha be activate then the appropriate hook is call mouse press mouse event evt popup timer popup timer stop popup timer x x x when we want to support multiple view we have to implement set view drawing view e get source evt is popup trigger handle popup menu evt mouse press evt popup timer timer 1000 action listener action perform action event aevt handle popup menu evt popup timer popup timer set repeat popup timer start mouse listener mouse release event the popup trigger ha be activate then the appropriate hook is call mouse release mouse event evt popup timer popup timer stop popup timer mouse release evt evt is popup trigger handle popup menu evt mouse drag mouse event evt popup timer popup timer stop popup timer popup menu || popup menu is visible mouse drag evt mouse click mouse event evt mouse click evt evt get click count 2 handle click evt hook which can be overriden by subclass to provide specialise behaviour in the event of a popup trigger handle popup menu mouse event evt point p point evt get x evt get y figure figure get view find figure p figure || drawing action size 0 show popup menu figure p evt get component popup menu show popup menu figure figure point p component c j popup menu menu j popup menu popup menu menu j menu submenu submenu name link list action popup action link list action figure link list action figure action link list action figure get action view to drawing p popup action size 0 figure action size 0 popup action add popup action add all figure action popup action size 0 selection action size 0 popup action add popup action add all selection action popup action size 0 drawing action size 0 popup action add popup action add all drawing action hash map button group button group hash map button group action a popup action a a get value action s u b m e n u k e y submenu name || submenu name equal a get value action s u b m e n u k e y submenu name a get value action s u b m e n u k e y submenu j menu submenu name menu add submenu submenu name submenu a submenu submenu add separator menu add separator button button a get value action b u t t o n g r o u p k e y button group bg button group get a get value action b u t t o n g r o u p k e y bg bg button group button group put a get value action b u t t o n g r o u p k e y bg button j radio button menu item a bg add button button set select a get value action s e l e c t e d k e y t r u e a get value action s e l e c t e d k e y button j check box menu item a button set select a get value action s e l e c t e d k e y t r u e button j menu item a submenu submenu add button menu add button menu show c p x p y hook which can be overriden by subclass to provide specialise behaviour in the event of a click handle click mouse event evt drawing view v get view point po point evt get x evt get y handle handle v find handle po handle handle track click po evt get modifier ex point2 d p view to drawing po figure out figure get view find figure po figure figure out figure figure tool figure tool figure get tool p figure tool figure get drawing find figure inside p figure figure tool figure get tool p figure tool set tracker figure tool figure tool mouse press evt out figure handle mouse click p evt get view v clear selection v add to selection out figure v clear selection v add to selection out figure v set handle detail level v get handle detail level 1 ? 0 1 v set handle detail level v get handle detail level + 1 
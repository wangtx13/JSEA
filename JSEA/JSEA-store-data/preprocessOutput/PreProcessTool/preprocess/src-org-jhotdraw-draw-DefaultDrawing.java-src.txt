# drawing 2 0 2006 01 14 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org ??? org jhotdraw draw org jhotdraw reverse list geom event undo org jhotdraw drawing author wern randelshof 2 0 2006 01 14 change to support precision coordinate 1 0 2003 12 01 derive from jhotdraw 5 4b1 drawingextend drawingimplement figure listener undoable edit listener list figure figure list figure need sorting create a instance drawing index of figure figure figure index of figure basic add index figure figure figure add index figure figure add figure listener figure add undoable edit listener invalidate sort order basic remove figure figure figure remove figure figure remove figure listener figure remove undoable edit listener invalidate sort order draw graphics2 d g get lock ensure sort list figure to draw list figure figure size rectangle clip rect g get clip bound figure f figure f get draw bound intersect clip rect to draw add f draw g to draw draw graphics2 d g collection figure figure figure f figure f is visible f draw g collection figure sort collection figure c hash set figure unsort hash set figure unsort add all c list figure sort list figure c size figure f figure unsort contain f sort add f unsort remove f figure f c unsort contain f sort add f unsort remove f sort figure area invalidate figure event e fire area invalidate e get invalidate area figure change figure event e invalidate sort order fire area invalidate e get invalidate area figure add figure event e figure remove figure event e figure request remove figure event e remove e get figure figure find figure point2 d p figure f get figure front to back f is visible f contain p f figure find figure except point2 d p figure ignore figure f get figure front to back f ignore f is visible f contain p f figure find figure except point2 d p collection figure ignore figure f get figure front to back ignore contain f f is visible f contain p f collection figure find figure rectangle2 d bound list figure intersection list figure figure f figure f is visible f get bound intersect bound intersection add f intersection collection figure find figure within rectangle2 d bound list figure contain list figure figure f figure f is visible bound contain f get bound contain add f contain collection figure get figure collection unmodifiable collection figure figure find figure inside point2 d p figure f find figure p f ? f find figure inside p an iterator to iterate in z order front to back over the figure list figure get figure front to back ensure sort reverse list figure figure bring to front figure figure figure remove figure figure add figure invalidate sort order fire area invalidate figure get draw bound send to back figure figure figure remove figure figure add 0 figure invalidate sort order fire area invalidate figure get draw bound we propagate all edit event from our figure to undoable edit listener which have register with u undoable edit happen undoable edit event e fire undoable edit happen e get edit figure attribute change figure event e contain figure f figure contain f invalidate the sort order invalidate sort order need sorting ensure that the figure are sort in z order sequence from back to front ensure sort need sorting collection sort figure figure layer comparator i n s t a n c e need sorting 
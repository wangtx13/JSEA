# save before action 2 0 2006 06 15 copyright c 2005 2006 wern randelshof staldenmattweg 2 immensee c h 6405 switzerland all right reserve software is the confidential and proprietary information of wern randelshof confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with wern randelshof org jhotdraw app action org jhotdraw io org jhotdraw gui org jhotdraw gui event org jhotdraw event io org jhotdraw app application org jhotdraw app project base action that can only be safely perform when the project ha no unsav change p the project ha no unsav change it is invoke immediately unsav change are present a dialog is show asking wheth the user want to discard the change cancel or save the change before do it the user choos to discard the chaneg to it is invoke immediately the user choos to cancel the action is abort the user choos to save the change the project is save and it is only invoke after the project wa successfully save author wern randelshof 2 0 2006 06 15 rework 1 2 2006 05 19 make filename acceptable by extension filter 1 1 2006 05 03 localize message 1 0 27 september 2005 create save before action project action component old focus owner create a instance save before action application app app action perform action event evt project p get current project p is enable resource bundle label resource bundle get l a f bundle org jhotdraw app label window w ancestor utility get window ancestor p get component old focus owner w ancestor ? w ancestor get focus owner p set enable p ha unsav change j option pane pane j option pane html + u i manager get option pane cs + label get save before message j option pane w a r n i n g m e s s a g e option label get save label get cancel label get dont save pane set option option pane set initial value option 0 pane put client property quaqua option pane destructive option 2 j sheet show sheet pane p get component sheet listener option select sheet event evt value evt get value value || value equal label get cancel p set enable value equal label get dont save it p p set enable value equal label get save save change p it p p set enable old focus owner old focus owner request focus save change project p p get j chooser chooser p get save chooser option chooser show save dialog j sheet show save sheet chooser p get component sheet listener option select sheet event evt evt get option j chooser a p p r o v e o p t i o n evt get chooser get filter extension filter extension filter evt get chooser get filter make acceptable evt get chooser get select evt get chooser get select save to p p set enable old focus owner old focus owner request focus save to p p get save to project p p execute worker construct p write i o e e finish value save p value save project p value value p set p mark change a save it p resource bundle label resource bundle get l a f bundle org jhotdraw app label j sheet show message sheet p get component html + u i manager get option pane cs + label get format couldnt save value j option pane e r r o r m e s s a g e p set enable old focus owner old focus owner request focus it project p 
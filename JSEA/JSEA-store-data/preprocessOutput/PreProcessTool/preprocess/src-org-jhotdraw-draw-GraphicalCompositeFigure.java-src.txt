# graphical composite figure 2 0 2006 01 14 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org ??? org jhotdraw draw io i o org jhotdraw geom undo event org jhotdraw draw attribute key org jhotdraw geom org jhotdraw xml dom input org jhotdraw xml dom output the graphical composite figure fill in the gap between a composite figure and other figure which mainly have a presentation purpose the graphical composite figure can be configure with any figure which take over the task rendering the graphical presentation a composite figure therefore the graphical composite figure manage contain figure like the composite figure doe but delegate it graphical presentation to another graphical figure which purpose it is to draw the container all contain figure the graphical composite figure add to the link composite figure composite figure by contain a presentation figure by which can not be remove normally the link composite figure composite figure can not be see without contain a figure because it ha no mechanism to draw itself it instead relie on it contain figure to draw themselve thereby giving the link composite figure composite figure it appearance howev the b graphical composite figure b s presentation figure can draw itself even when the b graphical composite figure b contain no other figure the b graphical composite figure b also us a link layout layout or layout it contain figure author wolfram kaiser original wern randelshof derive 2 0 2006 01 14 change to support precision coordinate 1 0 1 dezemb 2003 derive from jhotdraw 5 4b1 graphical composite figure composite figure hash map attribute key attribute hash map attribute key hash set attribute key forbid attribute figure which perform all presentation task composite figure a composite figure usually t have an own presentation but present only the sum of all it child figure presentation figure handle figure change in the child presentation figure handler presentation figure handler presentation figure handler presentation figure handler figure listener undoable edit listener graphical composite figure owner presentation figure handler graphical composite figure owner owner owner figure request remove figure event e owner remove e get figure figure remove figure event evt figure change figure event e owner is change owner will change owner fire figure change e owner change figure add figure event e figure attribute change figure event e figure area invalidate figure event e owner is change owner fire area invalidate e get invalidate area undoable edit happen undoable edit event e owner fire undoable edit happen e get edit constructor which us nothing a presentation figure constructor is need by the storable mechanism graphical composite figure constructor which create a graphical composite figure with a given graphical figure present it presentation figure figure which render the container graphical composite figure figure presentation figure set presentation figure presentation figure the logcal display area is delegate to the encapsulate presentation figure rectangle2 d get bound get presentation figure get bound get presentation figure get bound contain point2 d p get presentation figure get presentation figure contain p contain p add notify drawing drawing add notify drawing get presentation figure get presentation figure add notify drawing remove notify drawing drawing remove notify drawing get presentation figure get presentation figure remove notify drawing the draw area is delegate to the encapsulate presentation figure rectangle2 d get figure draw bound rectangle2 d r get presentation figure rectangle2 d presentation bound get presentation figure get draw bound r get figure draw bound r is empty r presentation bound r add presentation bound r get figure draw bound r move the figure is the that subclasser override client usually call display box basic set bound point2 d anchor point2 d get layout basic set bound anchor basic set presentation figure bound anchor rectangle2 d r get layout layout anchor basic set presentation figure bound point2 d r get x r get y point2 d math max x r get max x math max y r get max y invalidate basic set bound point2 d anchor point2 d basic set bound anchor basic set presentation figure bound point2 d anchor point2 d get presentation figure get presentation figure basic set bound anchor standard presentation which is delegate to the encapsulate presentation figure the presentation figure is move a well a all contain figure basic transform affine transform tx basic transform tx get presentation figure get presentation figure basic transform tx draw the figure is delegate to the encapsulate presentation figure draw figure graphics2 d g draw presentation figure g draw figure g draw presentation figure graphics2 d g get presentation figure get presentation figure draw g handle from the presentation figure collection handle create handle detail level link list handle handle link list handle detail level 0 move handle add move handle handle handle get presentation figure get handle set a figure which render composite figure the presentation task the composite figure are delegate to presentation figure presentation figure figure take over the presentation task set presentation figure figure presentation figure presentation figure presentation figure remove figure listener presentation figure handler presentation figure remove undoable edit listener presentation figure handler get drawing presentation figure remove notify get drawing presentation figure presentation figure presentation figure presentation figure add figure listener presentation figure handler presentation figure add undoable edit listener presentation figure handler get drawing presentation figure add notify get drawing f i x m e we should calculate the layout here get a figure which render composite figure the presentation task the composite figure are delegate to presentation figure figure take over the presentation task figure get presentation figure presentation figure graphical composite figure clone graphical composite figure that graphical composite figure clone that presentation figure presentation figure ? figure presentation figure clone that presentation figure that presentation figure add figure listener that presentation figure handler that presentation figure add undoable edit listener that presentation figure handler that remap hash map figure figure old to remap old to presentation figure presentation figure remap old to set an attribute of the figure attribute key name and semantics are define by the implement the figure set attribute attribute key key value forbid attribute || forbid attribute contain key will change get presentation figure get presentation figure set attribute key value set attribute key value old value attribute put key value fire attribute change key old value value fire undoable edit happen attribute change edit key old value value change set an attribute of the figure attribute key name and semantics are define by the implement the figure basic set attribute attribute key key value forbid attribute || forbid attribute contain key get presentation figure get presentation figure basic set attribute key value basic set attribute key value old value attribute put key value set attribute enable attribute key key b forbid attribute forbid attribute hash set attribute key b forbid attribute remove key forbid attribute add key get an attribute from the figure get attribute attribute key key get presentation figure get presentation figure get attribute key attribute contain key key ? key get value attribute get key applie all attribute of figure to that figure apply attribute to figure that map entry attribute key entry attribute entry set that set attribute entry get key entry get value write attribute dom output out i o figure prototype figure out get prototype is element open map entry attribute key entry attribute entry set attribute key key entry get key forbid attribute || forbid attribute contain key prototype value key get prototype attribute value key get prototype value attribute value || prototype value attribute value prototype value equal attribute value is element open out open element a is element open out open element key get key out write entry get value out close element is element open out close element read attribute dom input in i o in get element count a 0 in open element a i in get element count 1 i 0 i in open element i name in get tag name value in read attribute key key get attribute key name key key is assignable value forbid attribute || forbid attribute contain key set attribute key value in close element in close element attribute key get attribute key name attribute key support attribute map get name map attribute key get attribute hash map attribute key attribute is a that chop the point at the rectangle by get bound of the figure p figure which have a non rectangular shape need to override p take the following attribute into account attribute key s t r o k e c o l o r attribute key s t r o k e p l a c e m e n t and attribute key stroke total width point2 d chop point2 d from rectangle2 d r get bound s t r o k e c o l o r get grow s t r o k e p l a c e m e n t get c e n t e r grow attribute key get stroke total width o u t s e grow attribute key get stroke total width i n s e grow 0d geom grow r grow grow geom angle to point r geom point to angle r from 
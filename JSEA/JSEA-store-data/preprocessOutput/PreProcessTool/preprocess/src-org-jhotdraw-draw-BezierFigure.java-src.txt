# bezi figure 2 1 1 2006 06 08 1996 2006 it contributor disclose accordance draw geom undo io draw attribute key geom xml dom input xml dom output bezi figure use draw arbitrary shape using bezi path use draw open path close shape 2 1 1 2006 06 08 cap 2 1 2006 04 21 improve cap 2 0 2006 01 14 support coordinate 1 0 march 14 2004 author bezi figure attribute figure attribute key l o s e d attribute key close bezi path bezi path path cap path bezi path derive variable path we cache increase speed figure bezi path cap path create instance bezi figure create instance bezi figure close path bezi path l o s e d set close path set close close d r i n g s h p e n d b o u n d s t t r i b u t e s e d i t i n g o n n e t i n g figure connector specify location chop diamond connector see chop diamond connector connector find connector point2 d p connection figure prototype chop bezi connector connector find compatible connector connector start chop bezi connector o m p o s i t e f i g u r e s l o n i n g e v e n t h n d l i n g draw stroke graphics2 d g close grow attribute key get perpendicular draw growth grow 0d g draw path grow stroke g grow stroke grow attribute key get stroke total width s t r o k e m i t e r l i m i t f t o r get g draw g create stroke shape path g draw get cap path draw cap g draw cap graphics2 d g get point count 1 s t r t d e o r t i o n get bezi path cp get cap path point2 d p1 path get 0 0 point2 d p2 cp get 0 0 p2 equal p1 p2 path get 1 0 s t r t d e o r t i o n get draw g p1 p2 e n d d e o r t i o n get bezi path cp get cap path point2 d p1 path get path size 1 0 point2 d p2 cp get path size 1 0 p2 equal p1 p2 path get path size 2 0 e n d d e o r t i o n get draw g p1 p2 draw fill graphics2 d g close grow attribute key get perpendicular fill growth grow 0d g fill path grow stroke g grow stroke grow attribute key get stroke total width s t r o k e m i t e r l i m i t f t o r get g fill g create stroke shape path contain point2 d p close grow attribute key get perpendicular hit growth grow 0d path contain p grow stroke g grow stroke grow attribute key get stroke total width s t r o k e m i t e r l i m i t f t o r get g create stroke shape path contain p tolerance math 2f attribute key get stroke total width 2 get cap path outline contain p tolerance s t r t d e o r t i o n get bezi path cp get cap path point2 d p1 path get 0 0 point2 d p2 cp get 0 0 f i x m e check here cap path contain point geom line contain point p1 x p1 y p2 x p2 y p x p y tolerance e n d d e o r t i o n get bezi path cp get cap path point2 d p1 path get path size 1 0 point2 d p2 cp get path size 1 0 f i x m e check here cap path contain point geom line contain point p1 x p1 y p2 x p2 y p x p y tolerance check figure connect fill bezi figure connect connect close collection handle create handle detail level link list handle handle link list handle detail level 0 box handle kit add box handle handle handle add bezi scale handle 1 i 0 n path size i n i++ handle add bezi node handle i handle rectangle2 d get bound rectangle2 d bound path get bounds2 d make sure bound are empty bound width math 1 bound width bound height math 1 bound height bound rectangle2 d get figure draw bound rectangle2 d r get figure draw bound get node count 1 s t r t d e o r t i o n get point2 d p1 get point 0 0 point2 d p2 get point 1 0 r add s t r t d e o r t i o n get get draw bound p1 p2 e n d d e o r t i o n get point2 d p1 get point get node count 1 0 point2 d p2 get point get node count 2 0 r add e n d d e o r t i o n get get draw bound p1 p2 r validate validate path invalidate path invalidate cap path clone bezi path figure bezi path get bezi path bezi path path clone point2 d get point on path relative flatness path get point on path relative flatness set bezi path cloning firing event basic set bezi path bezi path value path value set close value close close get attribute l o s e d set close value l o s e d set value basic set attribute attribute key key value key l o s e d path set close value basic set attribute key value basic set bound point2 d anchor point2 d basic set start point anchor basic set end point invalidate basic transform affine transform tx path transform tx invalidate invalidate invalidate path invalidate path invalidate cap path invalidate cap path cap path path which cap path at end prevent under end cap bezi path get cap path cap path cap path bezi path path clone close cap path set close cap path size 1 s t r t d e o r t i o n get bezi path node p0 cap path get 0 bezi path node p1 cap path get 1 point2 d pp p0 get mask bezi path c2 m s k 0 pp p0 get control point 2 p1 get mask bezi path c1 m s k 0 pp p1 get control point 1 pp p1 get control point 0 radius s t r t d e o r t i o n get get decoration radius line length geom length p0 get control point 0 pp cap path set 0 0 geom cap pp p0 get control point 0 math radius line length e n d d e o r t i o n get bezi path node p0 cap path get cap path size 1 bezi path node p1 cap path get cap path size 2 point2 d pp p0 get mask bezi path c1 m s k 0 pp p0 get control point 1 p1 get mask bezi path c2 m s k 0 pp p1 get control point 2 pp p1 get control point 0 radius e n d d e o r t i o n get get decoration radius line length geom length p0 get control point 0 pp cap path set cap path size 1 0 geom cap pp p0 get control point 0 math radius line length cap path invalidate path cap path layout add control point add node bezi path node p add node get node count p add node list point add node index bezi path node p bezi path node point bezi path node p change basic add node index point layout fire undoable edit happen undoable edit get presentation punkt einf\u00fcgen undo cannot undo undo change basic remove node index redo cannot undo redo change basic add node index point add control point basic add node bezi path node p path add p invalidate add control point basic add node index bezi path node p path add index p set control point set node index bezi path node p change bezi path node old value path get index bezi path node value bezi path node p basic set node index value fire undoable edit happen bezi node edit index old value value set control point basic set node index bezi path node p path set index p get control point bezi path node get node index bezi path node path get index clone convenience getting point coordinate first control point specify node point2 d get point index path get index get control point 0 get point coordinate control point point2 d get point index coord path get index get control point coord set point coordinate control point set point index coord point2 d p change basic set point index coord p x x x fire undoable edit set point coordinate control point 0 at specify node basic set point index point2 d p bezi path node node path get index dx p x node x 0 dy p y node y 0 i 0 i node x length i++ node x i + dx node y i + dy invalidate set point coordinate control point basic set point index coord point2 d p bezi path node cp bezi path node path get index cp set control point coord p basic set node index cp convenience setting point coordinate start point basic set start point point2 d p basic set point 0 p convenience setting point coordinate end point basic set end point point2 d p basic set point get point count 1 p convenience getting start point point2 d get start point get point 0 0 convenience getting end point point2 d get end point get point get node count 1 0 find control point index 1 control point could found f i x m e move bezi path find node point2 d p bezi path tp path i 0 i tp size i++ bezi path node p2 tp get i p2 x 0 p x p2 y 0 p y i 1 remove point remove node change basic remove node remove point2 d at specify index remove node index bezi path node old point bezi path node path get index change basic remove node index layout fire undoable edit happen undoable edit get presentation punkt entfernen undo cannot undo undo change basic add node index old point redo cannot undo redo basic remove node index get segment polyline hit given point2 d index segment 1 segment wa hit x x x move bezi path find segment point2 d find fixme path iterator point2 d p1 p2 i 0 n get node count 1 i n i++ p1 path get i 0 p2 path get i+1 0 geom line contain point p1 x p1 y p2 x p2 y find x find y 3d i 1 join two segment one given point2 d hit node polyline two segment be join x x x move bezi path basic join segment point2 d join i find segment join i 1 i 1 remove node i split segment at given point2 d segment wa hit index segment 1 segment wa hit x x x move bezi path basic split segment point2 d split i find segment split i 1 add node i + 1 bezi path node split i+1 remove point2 d at specify index basic remove node index path remove index remove point2 d at specify index basic remove node path clear get node count get node count path size get point count get point count path size bezi figure clone bezi figure bezi figure clone path bezi path path clone invalidate restore geometry path set bezi path geometry get restore data path clone point2 d chop point2 d p close grow attribute key get perpendicular hit growth grow 0d path chop p grow stroke g grow stroke grow attribute key get stroke total width s t r o k e m i t e r l i m i t f t o r get geom chop g create stroke shape path p path chop p point2 d get center path get center point2 d get outermost point path get path index outermost node get control point 0 join two segment one given point2 d hit node polyline two segment be join basic join segment point2 d join tolerance path join segment join tolerance split segment at given point2 d segment wa hit index segment 1 segment wa hit basic split segment point2 d split tolerance path split segment split tolerance handle mouse click handle mouse click point2 d p mouse evt view view evt get click count 2 view get handle detail level 1 change index basic split segment p 5f view get scale factor index 1 bezi path node node get node index fire undoable edit happen undoable edit redo cannot redo redo change basic add node index node undo cannot undo undo change basic remove node index write dom output out i o write point out write attribute out write point dom output out i o out open element point close out add attribute close i 0 n get node count i n i++ bezi path node node get node i out open element p node mask 0 out add attribute mask node mask node keep colinear out add attribute colinear out add attribute x node x 0 out add attribute y node y 0 node x 1 node x 0 || node y 1 node y 0 out add attribute c1x node x 1 out add attribute c1y node y 1 node x 2 node x 0 || node y 2 node y 0 out add attribute c2x node x 2 out add attribute c2y node y 2 out close element out close element override read dom input i o read point read attribute read point dom input i o path clear open element point set close get attribute close i 0 n get element count p i n i++ open element p i bezi path node node bezi path node get attribute mask 0 get attribute x 0d get attribute y 0d get attribute c1x get attribute x 0d get attribute c1y get attribute y 0d get attribute c2x get attribute x 0d get attribute c2y get attribute y 0d node keep colinear get attribute colinear path add node path invalidate path close element close element 
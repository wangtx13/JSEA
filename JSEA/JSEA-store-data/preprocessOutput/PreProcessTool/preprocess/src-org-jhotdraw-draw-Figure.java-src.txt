# figure 3 0 2006 01 20 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org org jhotdraw draw org jhotdraw bean geom event undo event io org jhotdraw geom org jhotdraw xml dom storable the of a graphical figure p a figure know it display box and can draw itself a figure can be compose of several figure to interact and manipulate with a figure it can provide handle and connector p a figure ha a set of handle to manipulate it shape or attribute a figure ha one or more connector that define how to locate a connection point p figure can have an open end set of attribute an attribute is identify by an attribute key p implementation the figure are provide by figure author wern randelshof 3 0 2006 01 20 rework j2 s e 1 5 figure cloneable serializable dom storable d r a w i n g draw the figure and it decorator figure g the graphics2 d to draw to draw graphics2 d g get the layer of the figure the layer is use to determine the z ordering of a figure inside of a drawing figure with a high layer number are draw after figure with a lower number the z order of figure within the same layer is determine by the sequence the figure be add to a drawing figure add late to a draw after figure which have be add before a figure change it layer it must fire a figure listener figure change event to it figure listener f i x m e replace value by a layer get layer a figure is only draw by a drawing and by composite figure it is visible layout s should ignore invisible figure too is visible change the visible state of the figure p the figure fire figure listener figure change and undoable edit listener undoable edit happen operation change it visible state set visible value b o u n d s set the logical bound of the figure and of it decorator figure p is use by tool s which create a figure and by tool s which connect a figure to another figure p is a basic operation which doe not fire event start the start point of the bound end the end point of the bound see #get bound basic set bound point2 d start point2 d end the start point of the bound see #basic set bound point2 d get start point the end point of the bound see #basic set bound point2 d get end point the logical bound of the figure a a rectangle the logical bound are use by some handle adjust the figure rectangle2 d get bound the drawing bound box of the figure and of it decorator figure take line width line cap and other decoration into account note get draw bound must include the logical bound of the figure rectangle2 d get draw bound the prefer size is use by layout to determine the prefer size of a figure most figure s is the same a the dimension by get bound dimension2 d get prefer size get data which can be use to restore the shape of the figure after a basic transform ha be apply to it see #basic transform affine transform get restore data restore the shape of the figure to a previously store state restore to restore data transform the shape of the figure transformation using precision arithmethic are inherently lossy operation therefore it is recommend to use get restore data restore to to provide lossles undo redo functionality after the transform ha finish the bound of the decorator figure are change to match the transform bound of the figure p is a basic operation which doe not fire event tx the transformation basic transform affine transform tx a t t r i b u t e s set an attribute of the figure attribute key name and semantics are define by the implement the figure p on an attribute change the figure fire figure listener figure attribute change undoable edit listener undoable edit happen the shape is affect by an attribute change figure listener figure change is fire too set attribute attribute key key value set an attribute of the figure without firing event attribute key name and semantics are define by the implement the figure p use attribute key set typesafe access to see attribute key#set basic set attribute attribute key key value get an attribute from the figure p use attribute key get typesafe access to see attribute key#get the attribute value the figure doe not have an attribute with the specify key key get value get attribute attribute key key a view to all attribute of figure by convention an unmodifiable map is map attribute key get attribute e d i t i n g the user can manipulate figure operation tool s should not interact with figure is interactive check a point is contain by the figure p is use hit testing by tool s contain point2 d p create handle use to manipulate the figure detail level the detail level of the handle usually is 0 bound box handle and 1 point handle a collection of handle see handle collection handle create handle detail level a cursor the specify location cursor get cursor point2 d p a collection of action s the specify location p the collection may contain entry these entry are use interpret a separator in the popup menu p action can use the property figure a c t i o n s u b m e n u to specify a submenu collection action get action point2 d p a specialize tool the specify location p no specialize tool is available tool get tool point2 d p a tooltip the specify location get tooltip point2 d p c o n n e c t i n g check figure can be connect can connect get a connector figure at the given location a figure can have different connector at different location p the location of the connector prototype the prototype use to create a connection or unknown allow specific connector different connection figure connector find connector point2 d p connection figure prototype get a compatible connector the provide connector is part of figure the connector the provide connector is part of another figure a connector with the same semantics figure no compatible connector is available connector find compatible connector connector c is start connector set wheth the connector should be visible the specify courting connector connector can be optionally visible set connector visible is visible connection figure courting connection figure draw it connector is connector visible c o m p o s i t e f i g u r e s check wheth the given figure is contain in figure a figure include itself include figure figure the figure that contain the given point figure find figure inside point2 d p a decompositon of a figure into it part a figure is consider a a part of itself collection figure get decomposition c l o n i n g a clone of the figure clone after cloning a collection of figure the connection figure contain in collection still connect to the original figure instead of to the clone using operation and provide a map which map from the original collection of figure to the collection connection can be remapp to the figure remap map figure figure old to e v e n t h a n d l i n g inform a figure that it ha be add to the specify drawing the figure must inform all figure listener that it ha be add add notify drawing d inform a figure that it ha be remove from the specify drawing the figure must inform all figure listener that it ha be remove remove notify drawing d inform that a figure is about to change it shape p will change and change are typically use a pair before and after invoke one or multiple basic on the figure will change inform that a figure change it shape fire a figure listener figure change event the current display bound of the figure see #will change change inform that a figure ha invalidate it display area and need to be draw fire a figure listener area invalidate event invalidate fire a figure listener figure request remove event request remove handle a drop p the location of the mouse event drop figure the drop figure view the drawing view which is the source of the mouse event the figure should snap back to the location they be drag from handle drop point2 d p collection figure drop figure drawing view view handle a mouse click p the location of the mouse event evt the mouse event view the drawing view which is the source of the mouse event the figure consume the mouse click handle mouse click point2 d p mouse event evt drawing view view add a listener figure event s add figure listener figure listener l remove a listener figure event s remove figure listener figure listener l add a listener undoable edit event add undoable edit listener undoable edit listener l remove a listener undoable edit event remove undoable edit listener undoable edit listener l set a decorator figure set to no decorator is desire the decorator will use the same logical bound a figure it will be draw when the figure is draw set decorator figure value get the decorator figure figure get decorator 
# figure 3 0 2006 01 20 1996 2006 contributor right reserve thi disclose accordance term enter draw bean geom undo io geom xml dom storable graphical figure p figure know display box draw itself figure compose several figure interact manipulate figure provide handle connector p figure ha set handle manipulate shape attribute figure ha one more connector define how locate connection point p figure have open end set attribute attribute identify attribute key p figure are provide figure wern randelshof 3 0 2006 01 20 rework j2 s e 1 5 figure extend cloneable serializable dom storable d r i n g draw figure decorator figure g graphics2 d draw draw graphics2 d g get layer figure layer determine z ordering figure inside figure high layer number are draw after figure lower number z order figure within same layer determine sequence figure add figure add late draw after figure which have add before figure change layer fire figure listener figure change figure listener f i x m e replace value layer get layer figure draw composite figure visible layout s should ignore invisible figure too visible change visible state figure p figure fire figure listener figure change undoable edit listener undoable edit happen thi operation change visible state set visible value b o u n d s set logical bound figure decorator figure p thi tool s which create figure tool s which connect figure another figure p thi basic operation which doe fire start start point bound end end point bound see #get bound basic set bound point2 d start point2 d end start point bound see #basic set bound point2 d get start point end point bound see #basic set bound point2 d get end point logical bound figure rectangle logical bound are some handle adjust figure rectangle2 d get bound bound box figure decorator figure thi take line width line cap other decoration account note get draw bound include logical bound figure rectangle2 d get draw bound prefer size layout determine prefer size figure most figure s thi same dimension get bound dimension2 d get prefer size get data which restore shape figure after basic transform ha apply see #basic transform affine transform get restore data restore shape figure previously store state restore restore data transform shape figure transformation using precision arithmethic are inherently lossy operation therefore recommend get restore data restore provide lossles undo redo functionality after transform ha finish bound decorator figure are change match transform bound figure p thi basic operation which doe fire tx transformation basic transform affine transform tx t t r i b u t e s set attribute figure attribute key semantics are define implement figure p on attribute change figure fire figure listener figure attribute change undoable edit listener undoable edit happen shape affect attribute change figure listener figure change fire too set attribute attribute key key value set attribute figure firing attribute key semantics are define implement figure p attribute key set typesafe access thi see attribute key#set basic set attribute attribute key key value get attribute figure p attribute key get typesafe access thi see attribute key#get attribute value figure doe have attribute specify key key get value get attribute attribute key key view attribute thi figure convention unmodifiable map map attribute key get attribute e d i t i n g user manipulate thi figure thi operation tool s should interact thi figure interactive check point contain figure p thi hit testing tool s contain point2 d p create handle manipulate figure detail level detail level handle usually thi 0 bound box handle 1 point handle collection handle see handle collection handle create handle detail level cursor specify location cursor get cursor point2 d p collection action s specify location p collection contain entry these entry are interpret separator popup menu p action property figure t i o n s u b m e n u specify submenu collection action get action point2 d p specialize tool specify location p specialize tool available tool get tool point2 d p tooltip specify location get tooltip point2 d p o n n e t i n g check thi figure connect connect get connector thi figure at given location figure have different connector at different location p location connector prototype prototype create connection unknown thi allow specific connector different connection figure connector find connector point2 d p connection figure prototype get compatible connector provide connector thi figure connector provide connector another figure connector same semantics thi figure compatible connector available connector find compatible connector connector start connector set wheth connector should visible specify courting connector connector optionally visible set connector visible visible connection figure courting connection thi figure draw connector connector visible o m p o s i t e f i g u r e s check wheth given figure contain thi figure figure include itself include figure figure figure contain given point figure find figure inside point2 d p decompositon figure figure consider itself collection figure get decomposition l o n i n g clone figure clone after cloning collection figure connection figure contain thi collection still connect figure instead clone using thi operation provide map which map collection figure collection connection remapp figure remap map figure figure old e v e n t h n d l i n g inform figure ha add specify figure inform figure listener ha add add notify d inform figure ha remove specify figure inform figure listener ha remove remove notify d inform figure about change shape p change change are typically pair before after one multiple basic on figure change inform figure change shape thi fire figure listener figure change current display bound figure see #will change change inform figure ha invalidate display area need draw fire figure listener area invalidate invalidate fire figure listener figure request remove request remove handle drop p location mouse drop figure drop figure view view which mouse figure should snap back location they drag handle drop point2 d p collection figure drop figure view view handle mouse click p location mouse evt mouse view view which mouse figure consume mouse click handle mouse click point2 d p mouse evt view view add listener figure s add figure listener figure listener l remove listener figure s remove figure listener figure listener l add listener undoable edit add undoable edit listener undoable edit listener l remove listener undoable edit remove undoable edit listener undoable edit listener l set decorator figure set thi decorator desire decorator same logical bound thi figure draw when figure draw set decorator figure value get decorator figure figure get decorator 
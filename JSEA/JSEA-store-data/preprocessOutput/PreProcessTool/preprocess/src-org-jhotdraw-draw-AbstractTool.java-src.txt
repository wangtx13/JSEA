# tool 3 0 2006 02 15 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org ??? org jhotdraw draw org jhotdraw undo composite edit geom event event tool author wern randelshof 3 0 2006 02 15 update to handle multiple view 2 0 2006 01 14 change to support precision coordinate 1 0 2003 12 01 derive from jhotdraw 5 4b1 tool tool is set to is the active tool of the editor is active is set to the tool is do some work prevent the current view from being change when a mouse enter event is receive is working drawing editor editor point anchor point event listener list listener list event listener list create a instance tool add undoable edit listener undoable edit listener l listener list add undoable edit listener l remove undoable edit listener undoable edit listener l listener list remove undoable edit listener l activate drawing editor editor editor editor is active editor get view request focus deactivate drawing editor editor editor editor is active is active is active drawing view get view editor get view drawing editor get editor editor drawing get drawing get view get drawing point2 d view to drawing point p constrain point get view view to drawing p point2 d constrain point point p constrain point get view view to drawing p point2 d constrain point point2 d p get view get constrain constrain point p delete the selection depend on the tool could be select figure select point or select text edit delete get view get drawing remove all get view get select figure cut the selection into the clipboard depend on the tool could be select figure select point or select text edit cut copy the selection into the clipboard depend on the tool could be select figure select point or select text edit copy duplicate the selection depend on the tool could be select figure select point or select text edit duplicate paste the content of the clipboard depend on the tool could be select figure select point or select text edit paste key release key event evt fire tool do key type key event evt key press key event evt evt get source container editor set view editor find view container evt get source fire tool start evt get composite edit edit evt get key key event v k d e l e t e key event v k b a c k s p a c e edit delete key event v k a evt get modifier key event c t r l m a s k | key event m e t a m a s k 0 get view add to selection get view get drawing get figure key event v k l e f t collection figure figure get view get select figure affine transform tx affine transform tx translate 1 0 figure f figure f will change f basic transform tx f change get drawing fire undoable edit happen transform edit figure tx key event v k r i g h t collection figure figure get view get select figure affine transform tx affine transform tx translate 1 0 figure f figure f will change f basic transform tx f change get drawing fire undoable edit happen transform edit figure tx key event v k u p collection figure figure get view get select figure affine transform tx affine transform tx translate 0 1 figure f figure f will change f basic transform tx f change get drawing fire undoable edit happen transform edit figure tx key event v k d o w n collection figure figure get view get select figure get drawing fire undoable edit happen edit composite edit figur en verschieben affine transform tx affine transform tx translate 0 1 figure f figure f will change f basic transform tx f change get drawing fire undoable edit happen transform edit figure tx mouse click mouse event evt mouse enter mouse event evt is working editor set view editor find view container evt get source mouse exit mouse event evt mouse move mouse event evt mouse press mouse event evt drawing view view editor find view container evt get source view request focus anchor point evt get x evt get y is working fire tool start view mouse release mouse event evt is working add tool listener tool listener l listener list add tool listener l remove tool listener tool listener l listener list remove tool listener l notify all listener list that have register interest notification on event type fire tool start drawing view view tool event event notify all listener that have register interest guarantee to a non listener listener list get listener list process the listener last to first notify those that are interest in event i listener length 2 i 0 i 2 listener i tool listener lazily create the event event event tool event view rectangle 0 0 1 1 tool listener listener i+1 tool start event notify all listener list that have register interest notification on event type fire tool do tool event event notify all listener that have register interest guarantee to a non listener listener list get listener list process the listener last to first notify those that are interest in event i listener length 2 i 0 i 2 listener i tool listener lazily create the event event event tool event get view rectangle 0 0 1 1 tool listener listener i+1 tool do event notify all listener list that have register interest notification on event type fire area invalidate rectangle2 d r point p1 get view drawing to view point2 d r x r y point p2 get view drawing to view point2 d r x+r width r y+r height fire area invalidate rectangle p1 x p1 y p2 x p1 x p2 y p1 y notify all listener list that have register interest notification on event type fire area invalidate rectangle invalidate area tool event event notify all listener that have register interest guarantee to a non listener listener list get listener list process the listener last to first notify those that are interest in event i listener length 2 i 0 i 2 listener i tool listener lazily create the event event event tool event get view invalidate area tool listener listener i+1 area invalidate event draw graphics2 d g update cursor drawing view view point p handle handle view find handle p handle view set cursor handle get cursor figure figure view find figure p figure view set cursor figure get cursor view view to drawing p view set cursor cursor get cursor 
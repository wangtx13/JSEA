std xml parser nano xml $ revision 1 5 $ $ date 2002 03 24 11 37 00 $ $ r e l e s e 2 2 1 $ thi nano xml 2 2000 2002 scheemaeck right reserve thi provide imply hold damage arise thi grant thi purpose include application restriction 1 thi misrepresent write thi appreciate require 2 mark misrepresent 3 thi remove net n3 io i o io reader io reader enumeration property vector std xml parser core parser nano xml scheemaeck $ r e l e s e 2 2 1 $ $ revision 1 5 $ std xml parser implement i xml parser builder which create logical structure xml data i xml builder builder reader which parser retrieve data i xml reader reader entity resolv i xml entity resolv entity resolv validator process entity reference validate xml data i xml validator validator create parser std xml parser thi builder thi validator thi reader thi entity resolv xml entity resolv clean up when s destroy protect finalize throwable thi builder thi reader thi entity resolv thi validator finalize set builder which create logical structure xml data builder non builder set builder i xml builder builder thi builder builder builder which create logical structure xml data builder i xml builder get builder thi builder set validator validate xml data validator non validator set validator i xml validator validator thi validator validator validator validate xml data validator i xml validator get validator thi validator set entity resolv resolv non resolv set resolv i xml entity resolv resolv thi entity resolv resolv entity resolv non resolv i xml entity resolv get resolv thi entity resolv set reader which parser retrieve data reader reader set reader i xml reader reader thi reader reader reader which parser retrieve data reader i xml reader get reader thi reader pars data let builder create logical data structure logical structure build builder net n3 xml occur reading parse data parse xml thi builder start building thi reader get thi reader get line nr thi scan data thi builder get result xml e e e xml xml e init cause e xml e scan xml data element someth go wrong protect scan data thi reader at e o f thi builder get result str xml read thi reader ch str at 0 ch xml process entity str thi reader thi entity resolv ch thi scan some tag t allow d t namespace property \r skip whitespace xml invalid input reader get reader get line nr ` + ch + 0x + hex ch + scan xml tag allow d t d t section are allow at thi point namespace namespace u r i namespace list define namespace someth go wrong protect scan some tag allow d t namespace property namespace str xml read thi reader ch str at 0 ch xml unexpect entity reader get reader get line nr str ch ? thi process p i thi process special tag allow d t thi reader unread ch thi process element namespace namespace process processing instruction someth go wrong protect process p i xml skip whitespace thi reader target xml scan identifier thi reader xml skip whitespace thi reader reader reader p i reader thi reader target equal ignore xml thi builder processing instruction target reader reader close process tag start bang lt allow d t d t section are allow at thi point someth go wrong protect process special tag allow d t str xml read thi reader ch str at 0 ch xml unexpect entity reader get reader get line nr str ch allow d t thi process d t xml unexpect d t reader get reader get line nr d thi process doc type xml skip comment thi reader process d t section someth go wrong protect process d t xml check literal thi reader d t xml expect input reader get reader get line nr d t thi validator p data add thi reader get thi reader get line nr reader reader d t reader thi reader thi builder add p data reader thi reader get thi reader get line nr reader close process document type declaration occur reading parse data protect process doc type xml check literal thi reader o t y p e xml expect input reader get reader get line nr d o t y p e xml skip whitespace thi reader buffer buffer root element xml scan identifier thi reader xml skip whitespace thi reader ch thi reader read ch p xml scan reader xml skip whitespace thi reader ch thi reader read ch s xml scan reader xml skip whitespace thi reader ch thi reader read ch thi validator parse d t d thi reader thi entity resolv xml skip whitespace thi reader ch thi reader read ch xml expect input reader get reader get line nr ` b e g i n p t h randelshof t read d t d reader reader thi reader open stream thi reader start stream reader thi reader set thi reader set thi validator parse d t d thi reader thi entity resolv e n d p t h randelshof t read d t d process regular element namespace namespace u r i namespace list define namespace someth go wrong protect process element namespace property namespace full xml scan identifier thi reader full xml skip whitespace thi reader prefix colon index index colon index 0 prefix substring 0 colon index substring colon index + 1 vector attr vector vector attr value vector vector attr type vector thi validator element start full thi reader get thi reader get line nr ch ch thi reader read ch || ch thi reader unread ch thi process attribute attr attr value attr type xml skip whitespace thi reader property extra attribute property thi validator element attribute process full extra attribute thi reader get thi reader get line nr enumeration enm extra attribute key enm ha more element key enm next element value extra attribute get property key attr add element key attr value add element value attr type add element d t i 0 i attr size i++ key attr element at i value attr value element at i type attr type element at i key equal xmln namespace value key start xmln namespace put key substring 6 value prefix thi builder start element prefix namespace thi reader get thi reader get line nr thi builder start element prefix namespace get property prefix thi reader get thi reader get line nr i 0 i attr size i++ key attr element at i key start xmln value attr value element at i type attr type element at i colon index key index colon index 0 att prefix key substring 0 colon index key key substring colon index + 1 thi builder add attribute key att prefix namespace get property att prefix value type thi builder add attribute key value type prefix thi builder element attribute process prefix namespace thi builder element attribute process prefix namespace get property prefix ch thi reader read xml expect input reader get reader get line nr ` thi validator element end thi reader get thi reader get line nr prefix thi builder end element prefix namespace thi builder end element prefix namespace get property prefix buffer buffer buffer 16 buffer set length 0 str xml skip whitespace thi reader buffer str xml read thi reader str at 0 str at 1 # xml process entity str thi reader thi entity resolv str at 0 str xml read thi reader \0 str at 0 xml skip whitespace thi reader str xml scan identifier thi reader str equal full xml wrong closing tag reader get reader get line nr str xml skip whitespace thi reader thi reader read xml closing tag empty reader get reader get line nr thi validator element end full thi reader get thi reader get line nr prefix thi builder end element prefix namespace thi builder end element prefix namespace get property prefix ^ thi reader unread str at 0 thi scan some tag d t allow namespace property namespace clone ^ str at 0 ch xml process literal str buffer append ch reader unread str at 0 thi validator p data add thi reader get thi reader get line nr reader r content reader thi reader thi entity resolv buffer thi builder add p data r thi reader get thi reader get line nr r close process attribute element attr contain attribute attr value contain value attribute attr type contain type attribute someth go wrong protect process attribute vector attr vector attr value vector attr type key xml scan identifier thi reader xml skip whitespace thi reader xml read thi reader equal xml expect input reader get reader get line nr ` xml skip whitespace thi reader value xml scan thi reader thi entity resolv attr add element key attr value add element value attr type add element d t thi validator attribute add key value thi reader get thi reader get line nr 
xml nano xml $ revision 1 5 $ $ date 2002 02 03 21 19 38 $ $ r e l e s e 2 2 1 $ nano xml 2 2000 2002 purpose 1 2 3 net n3 io i o io reader io reader utility nano xml author $ r e l e s e 2 2 1 $ $ revision 1 5 $ xml skip remainder comment assume lt already read reader reader io i o occur reading data skip comment i xml reader reader i o xml parse reader read xml expect input reader get reader get line nr dash read 0 ch reader read ch dash read++ dash read 2 dash read 0 skip remainder current xml tag reader reader io i o occur reading data skip tag i xml reader reader i o xml parse level 1 level 0 ch reader read ch ++level level scan contain reader reader io i o occur reading data scan buffer i xml reader reader i o xml parse xml check literal reader u b l i xml skip whitespace reader append xml scan reader \0 xml skip whitespace reader xml scan reader \0 scan reader reader io i o occur reading data scan i xml reader reader i o xml parse xml check literal reader y s t e m xml skip whitespace reader xml scan reader \0 retrieve identifier data reader reader io i o occur reading data scan identifier i xml reader reader i o xml parse buffer result buffer ch reader read ch || ch || ch || ch || ch ch z || ch ch z || ch 0 ch 9 || ch \u007 e result append ch reader unread ch result retrieve delimit data reader reader entity escape character amp % entity resolv entity resolv io i o occur reading data scan i xml reader reader entity i xml entity resolv entity resolv i o xml parse buffer result buffer starting level reader get stream level delim reader read delim \ delim xml expect input reader get reader get line nr delimit str xml read reader entity ch str at 0 ch entity str at 1 # result append xml process literal str xml process entity str reader entity resolv ch reader unread ch str xml read reader str at 1 # result append xml process literal str result append str reader get stream level starting level ch delim ch 9 || ch 10 || ch 13 result append result append ch result append ch result process entity entity entity reader reader entity resolv entity resolv io i o occur reading data process entity entity i xml reader reader i xml entity resolv entity resolv i o xml parse entity entity substring 1 entity length 1 reader entity reader entity resolv get entity reader entity entity reader xml invalid entity reader get reader get line nr entity external entity entity resolv external entity entity reader start stream entity reader external entity process character literal entity entity io i o occur reading data process literal entity i o xml parse entity at 2 x entity entity substring 3 entity length 1 parse entity 16 entity entity substring 2 entity length 1 parse entity 10 skip whitespace reader reader reader buffer where put whitespace whitespace doe have store io i o occur reading data skip whitespace i xml reader reader buffer buffer i o ch buffer ch reader read ch || ch || ch ch reader read ch ch ch ch buffer append buffer append reader unread ch read character reader reader reader entity escape character amp % use indicate entity character entity expression like e g amp lt io i o occur reading data read i xml reader reader entity i o xml parse ch reader read buffer buf buffer buf append ch ch entity ch ch reader read buf append ch buf read character reader disallow entity reader reader entity escape character amp % use indicate entity read i xml reader reader entity i o xml parse str xml read reader entity ch str at 0 ch entity xml unexpect entity reader get reader get line nr str ch data start i literal i enough char are read determine result reader reader literal literal check io i o occur reading data check literal i xml reader reader literal i o xml parse i 0 i literal length i++ reader read literal at i xml parse indicate expect encounter data line nr line number data expect expect expect input line nr expect xml parse xml parse line nr expect + expect xml parse indicate entity could resolve data line nr line number data entity entity invalid entity line nr entity xml parse xml parse line nr invalid entity ` + entity + xml parse indicate entity reference unexpect at point data line nr line number data entity entity unexpect entity line nr entity xml parse xml parse line nr entity reference expect here + entity + xml parse indicate d t section unexpect at point data line nr line number data unexpect d t line nr xml parse xml parse line nr d t section expect here xml parse indicate expect at point data line nr line number data unexpect unexpect invalid input line nr unexpect xml parse xml parse line nr invalid input + unexpect xml parse indicate closing tag element doe match opening tag data line nr line number data expect opening tag wrong closing tag wrong closing tag line nr expect wrong xml parse xml parse line nr closing tag doe match opening tag ` + wrong + ` + expect + xml parse indicate extra data encounter closing tag data line nr line number data closing tag empty line nr xml parse xml parse line nr closing tag empty xml validation indicate element miss data line nr line number data parent element parent element miss element miss element miss element line nr parent element miss element xml validation xml validation xml validation m i s s i n g e l e m e n t line nr miss element attribute attribute value element + parent element + expect have + miss element xml validation indicate element unexpect data line nr line number data parent element parent element unexpect element unexpect element unexpect element line nr parent element unexpect element xml validation xml validation xml validation u n e x p e t e d e l e m e n t line nr unexpect element attribute attribute value unexpect + unexpect element + + parent element xml validation indicate attribute miss data line nr line number data element element attribute miss attribute miss attribute line nr element attribute xml validation xml validation xml validation m i s s i n g t t r i b u t e line nr element attribute attribute value element + element + expect attribute name + attribute xml validation indicate attribute unexpect data line nr line number data element element attribute unexpect attribute unexpect attribute line nr element attribute xml validation xml validation xml validation u n e x p e t e d t t r i b u t e line nr element attribute attribute value element + element + do expect attribute + name + attribute xml validation indicate attribute ha invalid value data line nr line number data element element attribute attribute attribute value value attribute invalid attribute value line nr element attribute attribute value xml validation xml validation xml validation t t r i b u t e i t h i n v l v l u e line nr element attribute attribute value invalid value attribute + attribute xml validation indicate # p d t element wa miss data line nr line number data parent element parent element miss p data line nr parent element xml validation xml validation xml validation m i s s i n g p d t line nr element attribute attribute value miss # p d t element + parent element xml validation indicate # p d t element wa unexpect data line nr line number data parent element parent element unexpect p data line nr parent element xml validation xml validation xml validation u n e x p e t e d p d t line nr element attribute attribute value unexpect # p d t element + parent element xml validation data line nr line number data message message element element attribute attribute attribute value value attribute validation line nr message element attribute attribute value xml validation xml validation xml validation m i s e r r o r line nr element attribute attribute value message 